all-versions:
- 1.0.1
author: David Wilson
basic-deps:
  base: '>=4.14 && <4.23'
  bytestring: '>=0.11.3.0 && <0.13'
  exceptions: '>=0.10.5 && <0.12'
  filepath: '>=1.4.101.0 && <=1.6'
  os-string: '>=2.0.1 && <=2.1'
changelog: |
  # Changelog for `os-string-compat`

  All notable changes to this project will be documented in this file.

  The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
  and this project adheres to the
  [Haskell Package Versioning Policy](https://pvp.haskell.org/).

  ## [1.0.1] - 2025-11-22

  First actual release.

  ### Fixed

  - Fixed lower bound on base
  - Fixed lower bounds on dependencies for tests
  - Tested with more versions of GHC on macOS
  - Fixed some documentation to work with more versions of Haddock

  ## [1.0.0] - 2025-11-11

  This was originally supposed to be the first actual release,
  but I wound up changing some things, but the changelog on
  Hackage wouldn't update. So I just decided to bump to version
  1.0.1.

  ### Added

  - Added proper tests and benchmarks.
  - Added equivalent functions to those in `os-string`.

  ## Pre-Release - 2025-10-26

  ### Changed

  - Created the repository.
  - First (public) "release".
  - Added an actual readme.
changelog-type: markdown
description: "# os-string-compat\n\n[![GitHub Actions status](https://github.com/Anteproperispomenon/os-string-compat/actions/workflows/haskell.yml/badge.svg)](https://github.com/Anteproperispomenon/os-string-compat/actions/workflows/haskell.yml)\n[![GitHub
  Actions status](https://github.com/Anteproperispomenon/os-string-compat/actions/workflows/haskell_cabal.yml/badge.svg)](https://github.com/Anteproperispomenon/os-string-compat/actions/workflows/haskell_cabal.yml)\n\n##
  Note on Hackage\n\nI haven't been able to get Stack/Cabal to generate versions of
  the documentation that\nproperly link to entities from other packages on Hackage.
  Unfortunately, this means\nthat you won't see documentation for functions that are
  just included directly from\nother packages, and you won't see links to their source
  code. To (partially) get around this,\nI ran Haddock while Stack was using an older
  version of [filepath](https://hackage.haskell.org/package/filepath)\nso that there
  would be more visible definitions. Hopefully this will improve the\ndocumentation.\n\nIf
  you want proper documentation of functions (and types), I recommend just checking
  out\n[os-string](https://hackage.haskell.org/package/os-string), since it shouldn't
  have\nthat problem.\n\nThis may be because I'm trying to compile the documentation
  on Windows. I might try\nat some point to auto-generate the docs with GitHub Actions...
  once I understand how\nto do that.\n\n## Note on macOS\n\nThis package may not work
  with older versions of GHC on macOS; when testing GHC 8.10.1\non macOS on GitHub
  Actions, it failed to install GHC. This seens to be because ARM support\nfor mac
  wasn't added until GHC 8.10.4 (and improved thereafter). To reflect this, macOS
  is\ntested on the oldest version of GHC that still successfully installs on GitHub.\n\nCurrently,
  the oldest version of GHC that is able to compile this package on macOS is `9.2.8`.\n\n##
  Intro and Purpose\n\nThis is a compatibility layer over [os-string](https://hackage.haskell.org/package/os-string)\nand
  (older versions of) [filepath](https://hackage.haskell.org/package/filepath). Notably,\nin
  versions `1.4.100 <= v < 1.5` of  `filepath`, the `newtype` `OsString` was defined
  in\nthe `filepath` package itself. However, you *can* import these versions of `filepath`\nalongside
  `os-string`, which *also* defines a `newtype` `OsString`. In fact, in versions\n`1.4.200`
  onwards of `filepath` it *recommends* importing `OsString` via `os-string`\ninstead
  of via `filepath`.\n\nThe problem is, you can't use functions from `os-string` on
  `OsString`s from `filepath`.\nThis may not seem like a problem at first, but `os-string`
  adds *a lot* of functions for\nworking directly on `OsString`s.\nThis isn't a problem
  if you have a version of `filepath` that's newer than `1.5`, but some\npackages
  *require* that `filepath` be older than `1.5`. If you're writing a package that\ndepends
  on such a package, you can't use any of the new functions from `os-string` directly.\n\nFortunately,
  in both `os-string` and older versions of `filepath`, `OsString` is ultimately\njust
  a `newtype` over `ShortByteString`[^1], so you can coerce between the two definitions
  of \n`OsString`[^2]. That's what this package does: it exposes new versions of functions
  from\n`os-string` that are just coerced to work on `OsString`/`OsPath` from `1.4.100+`.\n\nNote
  that this package works for both pre-1.5 versions of `filepath` *and* post-1.5 versions\nof
  `filepath`. On newer versions, it just re-exports the functions[^3] from `os-string`,
  since\n`filepath` 1.5+ depends on `os-string`. Therefore, you can import `os-string-compat`
  instead\nof `os-string` and you can use the functions regardless of which version
  of `filepath` you\nhave. If you're writing a library, you may want to depend on
  `os-string-compat` instead of\n`os-string`, since it'll enable you to put more lenient
  bounds on `filepath`.\n\n## Usage\n\n### Stack\n\nIf this package still isn't available
  on Hackage (i.e. if the link \n<https://hackage.haskell.org/package/os-string-compat>
  doesn't lead to\na valid package), you'll have to import this package by adding
  it to\nyour `stack.yaml` file. You'll also have to do this if you want to\nuse an
  exact *revision* of the package.\ne.g.\n\n```yaml\nextra-deps:\n- git: https://github.com/Anteproperispomenon/os-string-compat\n
  \ commit: 3ea425f103d2f14e3f9f7f713eb4291fee5b38a4 # keep this up-to-date\n```\n\nIf
  this package **is** available on Hackage, you may still have to add\nit to the `extra-deps`
  field in `stack.yaml`, but you won't have to \ngive an exact commit. You can just
  say e.g.\n\n```yaml\nextra-deps:\n- os-string-compat-1.0.1\n```\n\n### Cabal\n\nIf
  this package has been added to Hackage, you should be able\nto run `cabal update`
  and then add `os-string-compat >= 1.0.1`\nto the `build-depends` field in your `<package_name>.cabal`
  file.\n\nIf it still isn't available on Hackage, then you'll have to\nadd it to
  your `cabal.project` file. I haven't used this feature\nmyself, but it'll probably
  be something like this:\n\n```\npackages: .\n\nsource-repository-package\n    type:
  git\n    location: https://github.com/Anteproperispomenon/os-string-compat\n    tag:
  3ea425f103d2f14e3f9f7f713eb4291fee5b38a4\n```\n\n(See [cabal docs](https://cabal.readthedocs.io/en/3.4/cabal-project.html)\n
  for more info)\n\n### Using the Modules\n\nAfter that, instead of importing `System.OsString`
  etc, you import `System.OsString.Compat`\netc... That is, you use the same module
  name, but add `.Compat` to the end. Note that this\npackage doesn't include compatibility
  modules for `System.OsString.Data.ByteString.Short` or\n`System.OsString.Data.ByteString.Short.Word16`,
  since you can just import them directly\nwithout needing to worry about compatibility
  with `filepath`; when they were included\nin `filepath`, they were known as \"System.Os*Path*.Data.ByteString.Short\"
  etc..., so their\nmodule names won't clash.\n\n## To-Do\n\nPossibly add more versions
  of GHC to GitHub Actions workflows. Also look into how to\nuse GitHub Actions to
  automate building documentation/packages for Hackage. Also,\nfigure out how to cache
  dependencies for the Stack workflow.\n\n## Footnotes\n\n[^1]: Which is itself a
  `newtype` over `ByteArray`.\n[^2]: Yes, there is a difference between Windows `OsString`
  and POSIX `OsString`,\n      but so long as you coerce from `WindowsString` to `WindowsString`
  or \n      `PosixString` to `PosixString`, you should be okay.\n[^3]: There are
  a few functions that have different definitions depending on the\n      version
  of `os-string`, or only exist in newer versions of `os-string`.\n      For the former,
  such as `length`, this package exports its own version\n      based on newer versions
  of `length` from `os-string`. That way, its\n      behaviour is not dependent on
  the version of `os-string` used. For the\n      latter, more obscure functions just
  aren't exported if the version of\n      `os-string` isn't new enough, while others
  (especially functions that\n      the test suites rely on) are defined here, with
  their definitions just\n      copied from newer versions of `os-string`.\n"
description-type: markdown
hash: a7d0d8093bae02fdc7eb0db3b67189db602b295e8d2ef5fcfc109dbd35443e0e
homepage: https://github.com/Anteproperispomenon/os-string-compat#readme
latest: 1.0.1
license-name: BSD-3-Clause
maintainer: David Wilson
synopsis: Compatibility layer for os-string
test-bench-deps:
  QuickCheck: '>=2.7 && <2.20'
  base: '>=4.14 && <4.23'
  bytestring: '>=0.11.3.0 && <0.13'
  deepseq: '>=1.4.4 && <1.6'
  exceptions: '>=0.10.5 && <0.12'
  filepath: '>=1.4.101.0 && <=1.6'
  os-string: '>=2.0.1 && <=2.1'
  os-string-compat: '>=0'
  quickcheck-classes-base: '>=0.6.2 && <0.7'
  random: '>=1.2.1.3 && <1.4'
  tasty-bench: '>=0.4 && <0.5'
