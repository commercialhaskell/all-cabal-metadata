all-versions:
- 0.1.0
author: ''
basic-deps:
  aeson: '>=1.5 && <2.3'
  base: '>=4.9 && <5'
  bytestring: '>=0.10 && <0.13'
  eventium-core: '>=0'
  eventium-sql-common: '>=0'
  mtl: '>=2.2 && <2.4'
  persistent: '>=2.13 && <2.15'
  text: '>=1.2 && <2.2'
  uuid: '>=1.3 && <1.4'
changelog: ''
changelog-type: markdown
description: "# Eventium SQLite\n\nSQLite-based event store implementation for embedded
  and single-process applications.\n\n## Overview\n\n`eventium-sqlite` provides a
  lightweight, file-based event store implementation using SQLite. It's perfect for
  single-process applications, embedded systems, mobile apps, and scenarios where
  you want persistent storage without the complexity of a database server.\n\n## Features\n\n-
  ✅ **Zero Configuration** - No database server required\n- ✅ **File-Based Storage**
  - Single database file for easy backup\n- ✅ **ACID Transactions** - Full consistency
  guarantees from SQLite\n- ✅ **Optimistic Concurrency** - Version-based conflict
  detection\n- ✅ **Type-Safe Access** - Uses Persistent library\n- ✅ **Cross-Platform**
  - Works on Linux, macOS, Windows\n- ✅ **Embedded-Friendly** - Low resource footprint\n-
  ✅ **Easy Deployment** - No separate database process\n\n## When to Use SQLite\n\n###
  ✅ Good Fit\n- **Desktop Applications** - Local data storage\n- **CLI Tools** - Persistent
  command-line applications\n- **Mobile Apps** - Embedded event storage\n- **Development/Testing**
  - Persistent data without server setup\n- **Single-Process Systems** - No concurrent
  process access needed\n- **Edge Computing** - Resource-constrained environments\n\n###
  ⚠️ Consider Alternatives\n- **Multi-Process Systems** - Use `eventium-postgresql`
  instead\n- **High Write Concurrency** - PostgreSQL handles concurrent writes better\n-
  **Distributed Systems** - Need a client-server database\n- **Very Large Datasets**
  - PostgreSQL scales better for TB+ data\n\n## Installation\n\nAdd to your `package.yaml`:\n\n```yaml\ndependencies:\n
  \ - eventium-core\n  - eventium-sql-common\n  - eventium-sqlite\n  - persistent-sqlite
  \ # SQLite driver\n```\n\n## Usage\n\n```haskell\nimport Eventium.Store.Sqlite\nimport
  Database.Persist.Sqlite\n\nmain :: IO ()\nmain = do\n  -- Use file-based storage\n
  \ withSqlitePool \"events.db\" 1 $ \\pool -> do\n    -- Initialize schema\n    flip
  runSqlPool pool $ do\n      runMigration migrateAll\n      \n      -- Create event
  store\n      let store = makeSqliteEventStore pool\n      \n      -- Use with command
  handlers\n      result <- applyCommandHandler \n        (eventStoreWriter store)\n
  \       (eventStoreReader store)\n        commandHandler\n        aggregateId\n
  \       command\n```\n\n## Database Location\n\n### File-Based Storage\n```haskell\n--
  Relative path\nwithSqlitePool \"events.db\" 1 $ \\pool -> ...\n\n-- Absolute path\nwithSqlitePool
  \"/var/lib/myapp/events.db\" 1 $ \\pool -> ...\n\n-- User-specific location\nhome
  <- getHomeDirectory\nlet dbPath = home </> \".myapp\" </> \"events.db\"\nwithSqlitePool
  dbPath 1 $ \\pool -> ...\n```\n\n### In-Memory Storage (Testing)\n```haskell\n--
  Temporary in-memory database\nwithSqlitePool \":memory:\" 1 $ \\pool -> ...\n```\n\n##
  Configuration\n\n### Connection Pool\nSQLite works best with a single connection
  per process:\n\n```haskell\n-- Recommended for SQLite\nwithSqlitePool \"events.db\"
  1 $ \\pool -> ...\n```\n\n### WAL Mode (Recommended)\nEnable Write-Ahead Logging
  for better concurrent read performance:\n\n```haskell\nwithSqlitePool \"events.db\"
  1 $ \\pool -> do\n  flip runSqlPool pool $ do\n    rawExecute \"PRAGMA journal_mode=WAL;\"
  []\n    runMigration migrateAll\n```\n\nBenefits:\n- Readers don't block writers\n-
  Better performance for read-heavy workloads\n- Safer concurrent access\n\n## Performance\n\nTypical
  SQLite event store performance:\n- **Writes**: ~1000-3000 events/sec\n- **Reads**:
  ~5000-20000 events/sec\n- **Storage**: ~1KB per event (JSON serialized)\n\n### Optimization
  Tips\n\n1. **Use WAL Mode** - Better concurrent access\n2. **Batch Writes** - Multiple
  events per transaction\n3. **Index Strategy** - Default indexes cover common queries\n4.
  **VACUUM Regularly** - Reclaim space from deleted data\n5. **Synchronous Mode**
  - Balance durability vs speed\n\n## Backup & Recovery\n\n### Simple File Copy\n```bash\n#
  Stop application or ensure no writes\ncp events.db events.db.backup\n\n# Or use
  SQLite backup command\nsqlite3 events.db \".backup events.db.backup\"\n```\n\n###
  Continuous Backup\n```bash\n# With WAL mode, backup while app runs\nsqlite3 events.db
  \".backup events.db.backup\"\n```\n\n## Migration from In-Memory\n\n```haskell\n--
  Development: in-memory\ndevelopment :: IO ()\ndevelopment = withSqlitePool \":memory:\"
  1 $ \\pool -> ...\n\n-- Production: file-based\nproduction :: IO ()\nproduction
  = withSqlitePool \"events.db\" 1 $ \\pool -> ...\n```\n\n## Example: Complete CLI
  Application\n\n```haskell\nimport Eventium.Store.Sqlite\nimport System.Directory
  (getAppUserDataDirectory)\n\nmain :: IO ()\nmain = do\n  -- Store in application
  data directory\n  dataDir <- getAppUserDataDirectory \"myapp\"\n  createDirectoryIfMissing
  True dataDir\n  \n  let dbPath = dataDir </> \"events.db\"\n  \n  withSqlitePool
  dbPath 1 $ \\pool -> do\n    -- Initialize on first run\n    flip runSqlPool pool
  $ do\n      rawExecute \"PRAGMA journal_mode=WAL;\" []\n      runMigration migrateAll\n
  \   \n    -- Run application\n    runApp pool\n```\n\n## Tools\n\n### SQLite CLI\n```bash\n#
  Open database\nsqlite3 events.db\n\n# Inspect schema\n.schema\n\n# Query events\nSELECT
  * FROM events ORDER BY version DESC LIMIT 10;\n\n# Check database size\n.dbinfo\n```\n\n##
  Limitations\n\n- **Single Writer** - Only one process should write at a time\n-
  **File Locking** - May have issues on network filesystems\n- **Database Size** -
  Practical limit around 100GB-1TB\n- **Concurrent Writes** - Limited compared to
  PostgreSQL\n\n## Documentation\n\n- [Main README](../README.md) - Project overview\n-
  [SQL Common](../eventium-sql-common/) - Shared SQL utilities\n- [Design Documentation](../DESIGN.md)
  - Architecture details\n- [Examples](../examples/) - Bank and cafe examples use
  SQLite\n\n## License\n\nMIT - see [LICENSE.md](LICENSE.md)\n"
description-type: markdown
hash: ab99458c5a527c4107c9bc486ce77a6735f0e8d047e25405af5f9b4ac61f277c
homepage: https://github.com/aleks-sidorenko/eventium#readme
latest: 0.1.0
license-name: MIT
maintainer: Alexander Sidorenko
synopsis: SQLite implementations for eventium
test-bench-deps:
  HUnit: '>=0'
  aeson: '>=1.5 && <2.3'
  base: '>=4.9 && <5'
  bytestring: '>=0.10 && <0.13'
  eventium-core: '>=0'
  eventium-sql-common: '>=0'
  eventium-test-helpers: '>=0'
  hspec: '>=0'
  mtl: '>=2.2 && <2.4'
  persistent: '>=2.13 && <2.15'
  persistent-sqlite: '>=0'
  text: '>=1.2 && <2.2'
  uuid: '>=1.3 && <1.4'
