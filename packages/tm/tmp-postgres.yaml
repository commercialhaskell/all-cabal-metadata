homepage: https://github.com/jfischoff/tmp-postgres#readme
changelog-type: ''
hash: 5844e61f03285403ce74cd28c19f5dce4e382201dfbc523557d747c2b66b13d0
test-bench-deps:
  either: -any
  bytestring: -any
  tmp-postgres: -any
  unix: -any
  base: -any
  postgresql-libpq: -any
  hspec: -any
  port-utils: -any
  process: -any
  postgres-options: -any
  containers: -any
  postgresql-simple: -any
  mtl: -any
  transformers: -any
  temporary: -any
  directory: -any
maintainer: jonathangfischoff@gmail.com
synopsis: Start and stop a temporary postgres
changelog: ''
basic-deps:
  bytestring: -any
  ansi-wl-pprint: -any
  unix: -any
  base: ! '>=4.6 && <5'
  port-utils: -any
  process: ! '>=1.2.0.0'
  postgres-options: ! '>=0.2.0.0'
  async: -any
  containers: -any
  generic-monoid: -any
  postgresql-simple: -any
  transformers: -any
  temporary: -any
  directory: -any
all-versions:
- 0.1.0.0
- 0.1.0.1
- 0.1.0.2
- 0.1.0.3
- 0.1.0.4
- 0.1.0.5
- 0.1.0.6
- 0.1.0.7
- 0.1.0.8
- 0.1.1.0
- 0.1.1.1
- 0.1.2.0
- 0.1.2.1
- 0.1.2.2
- 0.2.0.0
- 0.3.0.0
- 0.3.0.1
- 1.0.0.0
- 1.0.0.1
- 1.0.0.2
- 1.0.1.0
- 1.2.0.0
- 1.2.0.1
- 1.2.1.0
- 1.3.0.0
- 1.4.0.0
- 1.5.0.0
- 1.6.0.0
- 1.7.0.0
author: Jonathan Fischoff
latest: 1.7.0.0
description-type: markdown
description: |
  [![Hackage](https://img.shields.io/hackage/v/tmp-postgres.svg?style=flat)](https://hackage.haskell.org/package/tmp-postgres)
  [![Travis CI Status](https://travis-ci.org/jfischoff/tmp-postgres.svg?branch=master)](http://travis-ci.org/jfischoff/tmp-postgres)
  # tmp-postgres

  `tmp-postgres` provides functions creating a temporary `postgres` instance.
  By default it will create a temporary directory for the data,
  a random port for listening and a temporary directory for a UNIX
  domain socket.

  Here is an example using the expection safe 'with' function:

  ```haskell
   with $ \db -> bracket (connectPostgreSQL (toConnectionString db)) close $ \conn ->
    execute_ conn "CREATE TABLE foo (id int)"
  ```

  To extend or override the defaults use `withConfig` (or `startConfig`).

  `tmp-postgres` ultimately calls `initdb`, `postgres` and `createdb`.
  All of the command line, environment variables and configuration files
  that are generated by default for the respective executables can be
  extended or overrided.

  All `tmp-postgres` by default is most useful for creating tests by
  configuring "tmp-postgres" differently it can be used for other purposes.

  * By disabling `initdb` and `createdb` one could run a temporary
  postgres on a base backup to test a migration.
  * By using the `stopPostgres` and `withRestart` functions one can test
  backup strategies.

  The level of custom configuration is extensive but with great power comes
  ability to screw everything up. `tmp-postgres` doesn't validate any custom
  configuration and one can easily create a `Config` that would not allow
  postgres to start.

  # Installation

  ## macOS
  ```
  $ brew install postgres
  $ stack install tmp-postgres
  ```

  ## Ubuntu

  Ubuntu's PostgreSQL installation does not put `initdb` on the PATH. We need to add it manually.

  ```
  $ sudo apt-get install postgresql-VERSION
  $ echo "export PATH=$PATH:/usr/lib/postgresql/VERSION/bin/" >> /home/ubuntu/.bashrc
  $ stack install tmp-postgres
  ```
license-name: BSD-3-Clause
