homepage: https://github.com/mrkkrp/mmark
changelog-type: markdown
hash: baae112183f2c437dd32e01c9e2eeb00118aea0eb1fc1a3c8a98992c8f39634b
test-bench-deps:
  modern-uri: ! '>=0.1.1 && <0.2'
  lucid: ! '>=2.6 && <3.0'
  base: ! '>=4.8 && <5.0'
  hspec: ! '>=2.0 && <3.0'
  text: ! '>=0.2 && <1.3'
  mmark: -any
  megaparsec: ! '>=6.3 && <7.0'
  criterion: ! '>=0.6.2.1 && <1.3'
  weigh: ! '>=0.0.4'
  foldl: ! '>=1.2 && <1.4'
  hspec-megaparsec: ! '>=1.0 && <2.0'
  QuickCheck: ! '>=2.4 && <3.0'
  aeson: ! '>=0.11 && <1.3'
maintainer: Mark Karpov <markkarpov92@gmail.com>
synopsis: Strict markdown processor for writers
changelog: ! "## MMark 0.0.3.0\n\n* Code can interrupt paragraphs now, as per Common
  Mark spec.\n\n* Implemented parsing of reference-links (including collapsed and\n
  \ shortcut-style links).\n\n* Implemented parsing of reference-style images (including
  collapsed and\n  shortcut-style images).\n\n* Added support for entity and numeric
  references (section 6.2 of the Common\n  Mark spec).\n\n* Improved quality of parse
  errors.\n\n## MMark 0.0.2.1\n\n* Improved performance of the parser. Mainly the
  inline-level parser to be\n  precise. The result is that now there are 3× less allocations
  and the code\n  runs about 3× faster on paragraphs and block quotes (it's about
  2.5×\n  faster for a big realistic document).\n\n* Improved quality of parse errors.\n\n##
  MMark 0.0.2.0\n\n* Now punctuation is stripped from header ids in\n  `Text.MMark.Extension.headerId`.\n\n*
  Added `scannerM` in `Text.MMark.Extension` and `runScannerM` in\n  `Text.MMark`.\n\n*
  Added support for block quotes.\n\n* Added support for unordered and ordered lists.\n\n##
  MMark 0.0.1.1\n\n* Fixed a bug in skipping of headers (only one newline after the
  header line\n  was picked, not all white space up to next block).\n\n## MMark 0.0.1.0\n\n*
  Initial release.\n"
basic-deps:
  modern-uri: ! '>=0.1.1 && <0.2'
  microlens-th: ! '>=0.4 && <0.5'
  lucid: ! '>=2.6 && <3.0'
  email-validate: ! '>=2.2 && <2.4'
  case-insensitive: ! '>=1.2 && <1.3'
  base: ! '>=4.8 && <5.0'
  data-default-class: -any
  parser-combinators: ! '>=0.2 && <1.0'
  unordered-containers: ! '>=0.2.5 && <0.3'
  text: ! '>=0.2 && <1.3'
  megaparsec: ! '>=6.3 && <7.0'
  containers: ! '>=0.5 && <0.6'
  text-metrics: ! '>=0.3 && <0.4'
  html-entity-map: ! '>=0.1 && <0.2'
  mtl: ! '>=2.0 && <3.0'
  foldl: ! '>=1.2 && <1.4'
  hashable: ! '>=1.0.1.1 && <1.3'
  deepseq: ! '>=1.3 && <1.5'
  microlens: ! '>=0.4 && <0.5'
  aeson: ! '>=0.11 && <1.3'
  yaml: ! '>=0.8.10 && <0.9'
all-versions:
- '0.0.1.0'
- '0.0.1.1'
- '0.0.2.0'
- '0.0.2.1'
- '0.0.3.0'
author: Mark Karpov <markkarpov92@gmail.com>
latest: '0.0.3.0'
description-type: markdown
description: ! "# MMark\n\n[![License BSD3](https://img.shields.io/badge/license-BSD3-brightgreen.svg)](http://opensource.org/licenses/BSD-3-Clause)\n[![Hackage](https://img.shields.io/hackage/v/mmark.svg?style=flat)](https://hackage.haskell.org/package/mmark)\n[![Stackage
  Nightly](http://stackage.org/package/mmark/badge/nightly)](http://stackage.org/nightly/package/mmark)\n[![Stackage
  LTS](http://stackage.org/package/mmark/badge/lts)](http://stackage.org/lts/package/mmark)\n[![Build
  Status](https://travis-ci.org/mrkkrp/mmark.svg?branch=master)](https://travis-ci.org/mrkkrp/mmark)\n[![Coverage
  Status](https://coveralls.io/repos/mrkkrp/mmark/badge.svg?branch=master&service=github)](https://coveralls.io/github/mrkkrp/mmark?branch=master)\n\nMMark
  (read “em-mark”) is a strict markdown processor for writers. “Strict”\nmeans that
  not every input is considered valid markdown document and parse\nerrors are possible
  and even desirable, because they allow to spot markup\nissues without searching
  for them in rendered document. If a markdown\ndocument passes MMark parser, then
  it'll likely produce HTML without quirks.\nThis feature makes it a good choice for
  writers and bloggers.\n\nMMark in its current state features:\n\n* A parser that
  produces high-quality error messages and does not choke on\n  first parse error.
  It is capable of reporting many parse errors where\n  makes sense.\n* An extension
  system allowing to create extensions that alter parsed\n  markdown document in some
  way. Some of them are available in the\n  [`mmark-ext`](https://hackage.haskell.org/package/mmark-ext)
  package.\n* A [`lucid`](https://hackage.haskell.org/package/lucid)-based render.\n\nThere
  is also a blog post announcing the project:\n\nhttps://markkarpov.com/post/announcing-mmark.html\n\n##
  MMark and Common Mark\n\nMMark mostly tries to follow the Common Mark specification
  as given here:\n\nhttps://github.com/jgm/CommonMark\n\nHowever, due to the fact
  that we do not allow inputs that do not make sense,\nand also try to guard against
  common mistakes (like writing `##My header`\nand having it rendered as a paragraph
  starting with hashes) MMark obviously\ncan't follow the specification precisely.
  In particular, parsing of inlines\ndiffers considerably from Common Mark (see below).\n\nAnother
  difference between Common Mark and MMark is that the latter supports\nmore (pun
  alert) common markdown extensions out-of-the-box. In particular,\nMMark supports:\n\n*
  parsing of an optional YAML block\n* strikeout using `~~this~~` syntax\n* superscript
  using `^this^` syntax\n* subscript using `~this~` syntax\n* automatic assignment
  of ids to headers\n* PHP-style footnotes, e.g. `[^1]` (NOT YET)\n* “pipe” tables
  (as used on GitHub) (NOT YET)\n\nOne do not need to enable or tweak anything for
  these to work, they are\nbuilt-in features.\n\n### Differences in inline parsing\n\nEmphasis
  and strong emphasis is an especially hairy topic in the Common Mark\nspecification.
  There are 17 ad-hoc rules defining interaction between `*`\nand `_` -based emphasis
  and more than an half of all Common Mark examples\n(that's about 300) test just
  this tricky logic.\n\nNot only it is hard to implement, it's hard to understand
  for humans too.\nFor example, this input:\n\n```\n*(*foo*)*\n```\n\nresults in the
  following HTML:\n\n```\n<p><em>(<em>foo</em>)</em></p>\n```\n\n(Note the nested
  emphasis.)\n\nCould it produce something like this instead?\n\n```\n<p><em>(</em>foo<em>)</em></p>\n```\n\nWell,
  why not? Without remembering those 17 ad-hoc rules, there going to be\na lot of
  tricky cases when a user won't be able to tell how markdown will be\nparsed.\n\nI
  decided to make parsing of emphasis, strong emphasis, and similar\nconstructs like
  strikethrough, subscript, and superscript more symmetric and\nless ad-hoc. This
  is a work in progress and I'm not fully satisfied with the\ncurrent approach as
  it does not allow to express some combinations of\ncharacters and markup, but in
  99% of practical cases it is identical to\nCommon Mark, and normal markdown intuitions
  will work OK for the users.\n\nLet's start by dividing all characters into three
  groups:\n\n* **Markup characters**, including the following: `*`, `~`, `_`, `` `
  ``,\n  `^`, `[`, `]`. These are used for markup and whenever they appear in a\n
  \ document, they must form valid markup constructions. To be used as\n  ordinary
  punctuation characters they must be backslash escaped.\n\n* **Space characters**,
  including space, tab, newline and carriage return.\n\n* **Other characters**, which
  include all characters not falling into the\n  two groups described above.\n\n**Markup
  characters** can be “converted” to **other characters** via\nbackslash escaping.
  We'll see how this is useful in a few moments.\n\nWe'll call **markdown characters**
  placed between **space characters** and\n**other characters** *left-flanking delimiter
  run*. These markup characters\nsort of hang on the left hand side of a word.\n\nSimilarly
  we'll call **markdown characters** placed between **other\ncharacters** and **space
  characters** *right-flanking delimiter run*. These\nhang on the right hand side
  of a word.\n\nEmphasis markup (and other similar things like strikethrough, which
  we won't\nmention explicitly anymore for brevity) can start only as left-flanking\ndelimiter
  run and end only as right-flanking delimiter run.\n\nThis produces a parse error:\n\n```\n*Something
  * is not right.\nSomething __is __ not right.\n```\n\nAnd this too:\n\n```\n__foo__bar\n```\n\nThis
  means that inter-word emphasis is not supported by this approach. (This\nis a pity,
  maybe I should adjust something to allow it.)\n\nThere is one more tricky thing.
  In some cases we want to end emphasis and\nhave full stop or other punctuation right
  after it:\n\n```\nHere it *goes*.\n```\n\nYou can see that the closing `*` is not
  in right-flanking position here, and\nso it's a parse error. To avoid this, some
  punctuation characters that\nnormally appear outside of markup were made “transparent”
  and thus they are\nregarded as white space, so the example above parses correctly
  and works as\nexpected. To put a transparent character inside emphasis, backslash
  escaping\nis necessary:\n\n```\nWe *\\(can\\)* have it.\n```\n\nHere `(` and `)`
  are transparent punctuation characters, just like `.`, so\nthey must be turned into
  **other characters** to go inside the emphasis.\nThis is a corner case and should
  not be common in practice.\n\nSo far the main limitation of this approach is the
  pains with inter-word\nmarkup, as in this example:\n\n```\n**We started to work
  on the *issue*.**\n```\n\nShould we escape `.` here? On one hand we should, to close
  `**`. But if we\ndo, the closing `*` won't be in right-flanking position anymore.
  God dammit.\n\n### Other differences\n\nBlock-level parsing:\n\n* If a line starts
  with hash signs it is expected to be a valid *non-empty*\n  header (level 1–6 inclusive).
  If you want to start a paragraph with\n  hashes, just escape the first hash with
  backslash and that will be enough.\n* Setext headings are not supported for the
  sake of simplicity.\n* Fenced code blocks must be explicitly closed by a closing
  fence. They are\n  not closed by the end of document or by start of another block.\n*
  Lists and block quotes are defined by column at which their content\n  starts. Content
  belonging to a particular list or block quote should start\n  at the same column
  (or greater column, up to the column where indented\n  code blocks start). As a
  consequence of this, block quotes do not feature\n  “laziness”\n* Block quotes are
  started by a single `>` character, it's not necessary to\n  put a `>` character
  at beginning of every line belonging to a quote (in\n  fact, this would make every
  line a separate block quote).\n* Paragraphs can be interrupted by unordered and
  ordered lists with any\n  valid starting index.\n* HTML blocks are not supported
  because the syntax conflicts with autolinks\n  and the feature is a hack to compensate
  for the lack of extensibility and\n  customization in the original markdown.\n\nInline-level
  parsing:\n\n* MMark does not support hard line breaks represented as double space
  before\n  newline. Nevertheless, hard line breaks in the form of backslash before\n
  \ newline are supported (these are more explicit too).\n* All URI references (in
  links, images, autolinks, etc.) are parsed as per\n  RFC 3986, no support for escaping
  or support for entity and numeric\n  character references is provided. In addition
  to that, when a URI\n  reference in not enclosed with `<` and `>`, then closing
  parenthesis\n  character `)` is not considered part of URI (use `<uri>` syntax if
  you\n  want a closing parenthesis as part of a URI).\n* Putting links in text of
  another link is not allowed, i.e. no nested links\n  is possible.\n* Putting images
  in description of other images is not allowed (similarly to\n  the situation with
  links).\n* HTML inlines are not supported for the same reason why HTML blocks are
  not\n  supported.\n\n### Additional information about MMark-specific extensions\n\n*
  YAML block must start with three hyphens `---` and end with three hyphens\n  `---`.
  It can only be placed at the beginning of a markdown document.\n  Trailing white
  space after the `---` sequences is allowed.\n\n## Contribution\n\nIssues, bugs,
  and questions may be reported in [the GitHub issue tracker for\nthis project](https://github.com/mrkkrp/mmark/issues).\n\nPull
  requests are also welcome and will be reviewed quickly.\n\n## License\n\nCopyright
  © 2017 Mark Karpov\n\nDistributed under BSD 3 clause license.\n"
license-name: BSD3
