all-versions:
- 0.1.0.0
- 0.2.0.0
- 0.2.1.0
- 0.2.2.0
- 0.2.3.0
- 0.3.0.0
- 0.3.1.0
- 0.3.2.0
- 0.3.3.0
author: Michał J. Gajda
basic-deps:
  HaTeX: '>=3.23.0 && <4'
  base: '>=4.7 && <5'
  blaze-html: '>=0.9.2 && <1'
  blaze-markup: '>=0.8.3 && <1'
  containers: '>=0.6.7 && <1'
  ghc-syntax-highlighter: '>=0.0.12 && <1'
  optics-core: '>=0.4.1 && <1'
  optics-th: '>=0.4.1 && <1'
  optparse-applicative: '>=0.19.0 && <1'
  pandoc-filter-indent: '>=0'
  pandoc-types: '>=1.23.1 && <2'
  skylighting: '>=0.14.7 && <1'
  text: '>=2.0.2 && <3'
changelog: |
  # Changelog for pandoc-filter-indent

  ## 0.3.3.0 Nov 17 2025

  ### Unicode and Operator Support
    - Add comprehensive support for GHC UnicodeSyntax extension operators
      - Unicode lambda (λ) now correctly renders as `\lambda`
      - All GHC UnicodeSyntax operators now supported: ∷, ⇒, →, ←, ⤚, ⤙, ⤜, ⤛, ★, ∀, ⦇, ⦈, ⟦, ⟧, ⊸
      - ASCII and Unicode versions of operators produce identical LaTeX output
    - Fix unicode lambda (λ) character handling in both Haskell and Skylighting tokenizers
      - Add `splitUnicodeLambda` to handle tokens like "λx" → ["λ", "x"]
    - Fix lambda expressions rendering in LaTeX math mode
    - Fix backslash operators (\, \\, \/, /\, etc.) rendering
    - Add preprocessing for Skylighting tokenizer to handle split backslash operators
    - Add `fixBracketOperators` to merge GHC bracket operators: (|, |), [|, |]
    - >< as Cartesian product (\times)
    - :-> as \longmapsto
    - **Design choice**: `*` renders as `\times` (multiplication) since modern Haskell uses `Type` for kinds
      - Unicode `★` renders as `\star` for legacy kind annotations
      - Tokenizers cannot distinguish between kind and multiplication contexts
      - TODO: Make this configurable for projects with legacy kind syntax

  ### Tokenizer Differences and Solutions
    - **Root cause identified**: Haskell and Skylighting tokenizers produce different token types
      - Haskell tokenizer: most operators → TOther
      - Skylighting tokenizer: some operators → TOperator (e.g., *, >-, -<, >>-, -<<)
      - Unicode ∀: TKeyword (Haskell) vs TOther (Skylighting)
      - Unicode λ: TVar (Haskell) vs TOther (Skylighting)
    - **Solution**: Introduced `OpOrOther` pattern synonym using PatternSynonyms extension
      - Eliminates code duplication when handling same operator from both tokenizers
      - Cleaner syntax: `formatToken (OpOrOther "->") = mathop "to"`

  ### Bug Fixes
    - Fix `extraColumns` and `tableColumns` deduplication mismatch
      - Both now use text column position deduplication to avoid gaps in table column indices
      - Fixes `prop_tableColumns` test failure on inputs like "\n a"
    - Rename subscripts to subAndSuperscripts with proper superscript support

  ### Testing
    - Add comprehensive test suite for lambda expressions and backslash operators
    - Add unit tests for all GHC UnicodeSyntax operators (UnicodeOperatorSpec)
      - Tests verify ASCII and Unicode versions produce identical LaTeX output
      - Tests now fail on error instead of just warning (enforced with error function)
    - Add tokenizer comparison tests (TokenizerTest)
    - Refactor test suite: extract common test pattern into helper function
    - Improve test readability: reduce code duplication in property tests

  ### Code Quality
    - Code cleanup: remove unused LANGUAGE pragmas, add missing pragmas
    - Code cleanup: use newtype for single-field records, use concatMap and elemIndex
    - Code cleanup: remove redundant $ operators and brackets
    - Code cleanup: fix pattern matching style (otherwise -> _)
    - Code cleanup: use hPrint instead of hPutStrLn . show

  ### Documentation
    - Add UNICODE_OPERATORS.md explaining Unicode operator support, design decisions, and limitations
    - Document tokenizer differences and solutions
    - Document the `*` vs `★` rendering choice with rationale

  ## Release history

  0.3.2.0 Sep 29 2021
    - stacked subscripts
    - lambda in Haskell tokenizer
    - greek letters for special variable names: eps, pi, rho
    - automatically append required LaTeX packages (broken for Beamer output)
    - Mapsto for |=>

  0.3.1.0 Jan 15 2021
    - Slightly improved formatting with SkyLighting and LaTeX

  0.3.0.0 Jan 15 2021
    - Support default syntaxes from skylighting.

  0.2.3.0 Jan 12 2021
    - fixed minor issue that disabled inline rendering.

  0.2.2.0 Jan 12 2021
    - Fixed problem with declaring too few columns in LaTeX
    - Inline code formatting
    - Removed indent marks from parenthesised operators: "(+)"
    - Removed indent marks from functions promoted to operators like "`mappend`"
    - Fixed rendering of indent mark at the start of the column

  0.1.0.0 Dec 1 2020
    - Initial release supporting LaTeX and HTML output

  0.2.0.0 Dec 2 2020
    - Preliminary support for Tikzmarks
    - Updated README

  0.2.1.0 Dec 2 2020
    - Extended code documentation
    - Cleanups
changelog-type: markdown
description: |
  # pandoc-filter-indent

  Pandoc filter that intelligently typesets code by detecting indentation boundaries and aligning operators.

  ## Quick Start

  Install via Stack:

  ```bash
  stack install pandoc-filter-indent
  ```

  Use with Pandoc:

  ```bash
  pandoc --filter pandoc-filter-indent input.md -o output.pdf
  pandoc --filter pandoc-filter-indent input.md -o output.html
  ```

  ## What it does

  Transforms code blocks into well-aligned, tabular layouts that highlight code structure. Instead of plain monospaced code, you get properly aligned operators, function signatures, and nested structures.

  **Input:**

  ````markdown
  ```{.haskell}
  class Eq      a
     => Compare a where
    compare :: a -> a -> Ordering
    (>=)    :: a -> a -> Bool
  ```
  ````

  **Output:** Rendered with operators vertically aligned in clean tables, using mathematical symbols (→, ⇒, ≥) in LaTeX/PDF output.

  ## Features

  - **Smart alignment** - Detects and aligns operators (`::`, `=`, `->`, etc.) using GHC lexer
  - **Multiple languages** - Haskell (GHC), Python, or generic indentation-based formatting
  - **Flexible output** - LaTeX tables, HTML tables, or Pandoc native tables
  - **Symbol beautification** - Converts operators to mathematical symbols (optional)
  - **Lightweight** - Simple Pandoc filter, easy to integrate

  ## Usage

  Mark code blocks with language attribute:

  ````markdown
  ```{.haskell}
  -- your Haskell code
  ```
  ````

  Or use alternate lexers:

  ````markdown
  ```{.python}
  # your Python code
  ```
  ````

  For generic indentation-based alignment:

  ````markdown
  ```{.haskell lexer=indent}
  -- any indented code
  ```
  ````

  ## Options

  Configure via code block attributes:

  - `lexer=haskell` - GHC lexer (default)
  - `lexer=python3` - Python lexer
  - `lexer=indent` - Indent-only alignment
  - `lexer=spaces` - Space-based alignment
  - `debug=true` - Show column boundaries for debugging

  Example:

  ````markdown
  ```{.haskell debug=true}
  yourCode :: Here
  ```
  ````

  ## Full Documentation

  For detailed algorithm explanation, implementation guide, and advanced usage, see [DESCRIPTION.md](DESCRIPTION.md).

  **See also:** [Complete Unicode operator symbol mapping](DESCRIPTION.md#appendix-operator-symbol-replacement) for all supported operator conversions (→, ⇒, ≥, ⊥, ∅, etc.).

  ## Links

  - **GitHub:** <https://github.com/migamake/pandoc-filter-typeset-code>
  - **Hackage:** <https://hackage.haskell.org/package/pandoc-filter-indent>
  - **Issues:** <https://github.com/migamake/pandoc-filter-typeset-code/issues>

  ## License

  BSD3 - see LICENSE file
description-type: markdown
hash: 519a6e0d076ee22ff381626397ef07486c73486d14d3e9f95166bd8915b9f38d
homepage: https://github.com/migamake/pandoc-filter-typeset-code#readme
latest: 0.3.3.0
license-name: BSD-3-Clause
maintainer: mjgajda@migamake.com
synopsis: Pandoc filter formatting Haskell code fragments using GHC lexer.
test-bench-deps:
  HaTeX: '>=3.23.0 && <4'
  QuickCheck: '>=0'
  base: '>=4.7 && <5'
  blaze-html: '>=0.9.2 && <1'
  blaze-markup: '>=0.8.3 && <1'
  ghc-lib-parser: '>=0'
  ghc-syntax-highlighter: '>=0.0.12 && <1'
  optics-core: '>=0.4.1 && <1'
  optics-th: '>=0.4.1 && <1'
  pandoc-filter-indent: '>=0'
  pandoc-types: '>=1.23.1 && <2'
  quickcheck-text: '>=0'
  skylighting: '>=0.14.7 && <1'
  text: '>=2.0.2 && <3'
