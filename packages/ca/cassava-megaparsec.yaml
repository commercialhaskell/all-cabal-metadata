homepage: https://github.com/stackbuilders/cassava-megaparsec
changelog-type: markdown
hash: 4efa2a6f758f975fba2c0fea7dc14279be4f8f0b56a882b58f78ac8534f676da
test-bench-deps:
  bytestring: '>=0.9 && <0.12'
  base: '>=4.8 && <5.0'
  hspec: '>=2.0 && <3.0'
  cassava: '>=0.4.2 && <0.6'
  hspec-megaparsec: '>=2.0 && <3.0'
  vector: '>=0.11 && <0.14'
  cassava-megaparsec: -any
maintainer: Mark Karpov <markkarpov92@gmail.org>
synopsis: Megaparsec parser of CSV files that plays nicely with Cassava
changelog: |
  ## Cassava Megaparsec 2.0.4

  * Allow bytestring-0.11

  ## Cassava Megaparsec 2.0.3

  * Exposing Internals

  ## Cassava Megaparsec 2.0.2

  * Add suppport for `megaparsec-9.0.0`

  ## Cassava Megaparsec 2.0.1

  * Add suppport for `megaparsec-8.0.0`

  ## Cassava Megaparsec 2.0.0

  * Works with Megaparsec 7.

  ## Cassava Megaparsec 1.0.0

  * Works with Megaparsec 6.

  * Instead of `Cec` we have `ConversionError` as custom component of error
    messages.

  ## Cassava Megaparsec 0.1.0

  * Initial release.
basic-deps:
  bytestring: '>=0.9 && <0.12'
  base: '>=4.8 && <5.0'
  unordered-containers: '>=0.2.7 && <0.3'
  megaparsec: '>=7.0 && <10.0'
  cassava: '>=0.4.2 && <0.6'
  vector: '>=0.11 && <0.14'
all-versions:
- 0.1.0
- 1.0.0
- 2.0.0
- 2.0.1
- 2.0.2
- 2.0.3
- 2.0.4
author: Mark Karpov <markkarpov92@gmail.org>
latest: 2.0.4
description-type: markdown
description: |
  # Cassava Megaparsec

  [![License MIT](https://img.shields.io/badge/license-MIT-brightgreen.svg)](http://opensource.org/licenses/MIT)
  [![Hackage](https://img.shields.io/hackage/v/cassava-megaparsec.svg?style=flat)](https://hackage.haskell.org/package/cassava-megaparsec)
  [![Stackage Nightly](http://stackage.org/package/cassava-megaparsec/badge/nightly)](http://stackage.org/nightly/package/cassava-megaparsec)
  [![Stackage LTS](http://stackage.org/package/cassava-megaparsec/badge/lts)](http://stackage.org/lts/package/cassava-megaparsec)
  [![Build Status](https://travis-ci.org/stackbuilders/cassava-megaparsec.svg?branch=master)](https://travis-ci.org/stackbuilders/cassava-megaparsec)

  The package provides alternative parser for the
  [Cassava](https://hackage.haskell.org/package/cassava) package written with
  [Megaparsec](https://hackage.haskell.org/package/megaparsec) so you can get
  better error messages at expense of some speed.

  ## Quick start

  The package works seamlessly with Cassava by replacing the following
  functions:

  * `decode`
  * `decodeWith`
  * `decodeByName`
  * `decodeByNameWith`

  The functions work just the same as Cassava's equivalents, but also take
  name of file they parse (to include into error messages) and return typed
  high-quality error messages produced by
  [Megaparsec](https://hackage.haskell.org/package/megaparsec).

  The import section typically looks like this:

  ```haskell
  import Data.Csv hiding (decode, decodeWith, decodeByName, decodeByNameWith)
  import Data.Csv.Parser.Megaparsec (decode, decodeWith, decodeByName, decodeByNameWith)
  ```

  Next you call appropriate function and get either result of parsing
  identical to that of Cassava or error message. The error message is
  well-typed so you can examine it in Haskell code easily. Conversion error
  are considered parsing errors by the `cassava-megaparsec` package and are
  reported via custom error message component `Cec` supported by Megaparsec 5.
  Since Cassava's conversion errors are plain strings, we have no choice but
  to represent them as strings too:

  ```haskell
  -- | Custom error component for CSV parsing. It allows typed reporting of
  -- conversion errors.

  data Cec
    = CecFail String
    | CecIndentation Ordering Pos Pos
    | CecConversionError String
    deriving (Eq, Data, Typeable, Ord, Read, Show)
  ```

  To pretty print a error message use the `parseErrorPretty` function from
  `Text.Megaparsec`.

  This should be enough to start using the package, please consult Haddocks
  for detailed per-function documentation.

  ## License

  Copyright © 2016–2021 Stack Builders

  Distributed under MIT license.
license-name: MIT
