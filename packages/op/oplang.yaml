homepage: https://github.com/aionescu/oplang#readme
changelog-type: markdown
hash: 1a6efca8a8032d65337075bb6c886b8fa65b2d37593e3cbf8aba136f90ec7298
test-bench-deps: {}
maintainer: alxi.2001@gmail.com
synopsis: Stack-based esoteric programming language
changelog: |
  ## v0.3.0.0 \[2022-08-12\]

  * Upgrade to [`text`](https://hackage.haskell.org/package/text) v2 and use [`text-builder-linear`](https://hackage.haskell.org/package/text-builder-linear), improving compilation performance
  * Optimizer overhaul
    * Now uses a separate IR
    * Performs more optimizations, runs in a single pass
    * Generates smaller and slightly faster C code

  ## v0.2.0.0 \[2022-03-19\]

  * Parser error message improvements
  * Codegen improvements
  * **\[Breaking\]** Tailcalls are no longer optimized

  ## v0.1.0.0 \[2020-10-10\]

  * Initial release
basic-deps:
  base: '>=4.14 && <5'
  text: ^>=2
  megaparsec: ^>=9.2
  filepath: ^>=1.4.2
  process: ^>=1.6.14
  containers: ^>=0.6.5
  mtl: ^>=2.3
  transformers: ^>=0.6
  optparse-applicative: ^>=0.17
  text-builder-linear: ^>=0.1
  directory: ^>=1.3.7
all-versions:
- 0.1.0.0
- 0.2.0.0
- 0.3.0.0
author: Alex Ionescu
latest: 0.3.0.0
description-type: markdown
description: |
  # oplang

  [![Hackage](https://img.shields.io/hackage/v/oplang?style=for-the-badge)](https://hackage.haskell.org/package/oplang)

  OpLang is a stack-based esoteric programming language based on [Brainfuck](https://en.wikipedia.org/wiki/Brainfuck).

  ## Installing

  The compiler is available on [Hackage](https://hackage.haskell.org/package/oplang), and can be installed via [cabal](https://www.haskell.org/cabal/) (which can itself be installed via [ghcup](https://www.haskell.org/ghcup/)).

  ```sh
  cabal install oplang
  ```

  ## Usage

  To compile an OpLang file with default options, use:

  ```sh
  oplang code.op
  ./code.out
  ```

  For a list of available command-line options, use `oplang --help`.

  ## Building from source

  Prerequisites:

  * `GHC` >=8.10
  * `cabal` >=3.0

  (Both can be installed via [ghcup](https://www.haskell.org/ghcup/))

  ```sh
  cabal build
  cabal run . -- <args>
  ```

  ## Language Features

  OpLang is a strict superset of Brainfuck.

  Its main improvement is the addition of user-defined operators, which are analogous to user-defined functions in languages like C or Python.

  The "memory tape" in OpLang is specific to each operator invocation (akin to the stack space allocated for functions in C), and there is a separate "stack" which persists across operator invocations.

  Each cell in the tape(s) and stack is 1 byte, and overflow/underflow is allowed.

  The default size of the stack is 4KB, and the default size for each memory tape is 64KB. These can be modified via the command-line.

  ## Syntax

  OpLang has 10 "intrinsic" operators, 8 of which are the Brainfuck operators, with the same semantics:

  * `+`: Increment the current cell
  * `-`: Decrement the current cell
  * `<`: Move the current cell pointer to the left
  * `>`: Move the current cell pointer to the right
  * `,`: Read a character from stdin and store its ASCII value in the current cell
  * `.`: Interpret the current cell as an ASCII character and print it to stdout
  * `[`: Begin a loop (i.e. if the value at the current cell is zero, jump to the next `]`)
  * `]`: End a loop (i.e. if the value at the current cell is non-zero, jump to the previous `[`)

  And 2 of them are new operators that modify the stack:

  * `;`: Pop a value from the stack and store it into the current cell
  * `:`: Push the value of the current cell onto the stack

  An OpLang program consists of a series of custom operator definitions, followed by the "toplevel" (similar to a `main()` function in other languages).

  An operator definition consists of the operator's name, followed by the operator's body, enclosed in `{`/`}`.

  Single-line comments are supported, and are introduced by the `#` character.

  Here's a simple program that reads a character from stdin, adds 3 to it, and prints it back:

  ```oplang
  a { ; +++ : }
  ,: a ;.
  ```

  For more example programs, see the [examples](examples/) folder.

  ## License

  This repository is licensed under the terms of the GNU General Public License v3.

  For more details, see [the license file](LICENSE.txt).
license-name: GPL-3.0-only
