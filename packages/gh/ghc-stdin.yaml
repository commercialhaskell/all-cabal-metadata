homepage: ''
changelog-type: markdown
hash: 5cb8730b12692d8cd764bbcae72b81b0d1bcc6a4aab0a619641c788a15aa3aa2
test-bench-deps: {}
maintainer: alexey.radkov@gmail.com
synopsis: Compile source code from the standard input
changelog: |+
  ### 0.1.1.0

  - Using bytestrings when reading from stdin and writing to the temporary file.

  ### 0.1.0.0

  - Initial version.

basic-deps:
  ghc: '>=8.4.1'
  bytestring: -any
  base: '>=4.11.0.0 && <5'
  process: -any
  ghc-paths: -any
  temporary: -any
all-versions:
- 0.1.0.0
- 0.1.1.0
author: Alexey Radkov
latest: 0.1.1.0
description-type: markdown
description: "GHC frontend plugin GhcStdin\n============================\n\n[![Build
  Status](https://github.com/lyokha/ghc-stdin/workflows/CI/badge.svg)](https://github.com/lyokha/ghc-stdin/actions?query=workflow%3ACI)\n[![Hackage](https://img.shields.io/hackage/v/ghc-stdin.svg?label=hackage%20%7C%20ghc-stdin&logo=haskell&logoColor=%239580D1)](https://hackage.haskell.org/package/ghc-stdin)\n\nIn
  GHC, it is not possible to read source code from the standard input.\n\n```ShellSession\n$
  echo 'module Main where main = putStrLn \"Ok\"' | ghc -o simple_ok\nghc-9.2.3: no
  input files\nUsage: For basic information, try the `--help' option.\n```\n\nThis
  plugin makes this possible.\n\n```ShellSession\n$ echo 'module Main where main =
  putStrLn \"Ok\"' | ghc --frontend GhcStdin -ffrontend-opt=\"-o simple_ok\"\n[1 of
  1] Compiling Main             ( ghc-stdin-d8c31cf0ed893d79/ghc-stdin260612-0.hs,
  ghc-stdin-d8c31cf0ed893d79/ghc-stdin260612-0.o )\nLinking simple_ok ...\n$ ./simple_ok\nOk\n```\n\nNotice
  that GHC flags are passed via *-ffrontend-opt* in a single string.\n\nAnother use
  case is collecting exported FFI C functions from a module and\nputting them in a
  new shared library.\n\n```ShellSession\n$ export NGX_MODULE_PATH=/var/lib/nginx/x86_64-linux-ghc-9.2.3\n$
  echo 'module NgxHealthcheck where import NgxExport.Healthcheck ()' | ghc --frontend
  GhcStdin -ffrontend-opt=\"-Wall -O2 -dynamic -shared -fPIC -lHSrts_thr-ghc$(ghc
  --numeric-version) -L$NGX_MODULE_PATH -lngx_healthcheck_plugin -o ngx_healthcheck.so\"
  \n[1 of 1] Compiling NgxHealthcheck   ( ghc-stdin-74de48274545714b/ghc-stdin266454-0.hs,
  ghc-stdin-74de48274545714b/ghc-stdin266454-0.o )\nLinking ngx_healthcheck.so ...\n```\n\n(this
  is a real-world example taken from\n[nginx-healthcheck-plugin](https://github.com/lyokha/nginx-healthcheck-plugin)).\n\nInternally,
  the plugin creates a temporary directory with a temporary source\nfile inside it
  with the contents read from the standard input. Then it spawns\nanother GHC process
  to compile this file with options passed in\n*-ffrontend-opt*.\n\n"
license-name: BSD-3-Clause
