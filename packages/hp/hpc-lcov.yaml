homepage: https://github.com/brandonchinn178/hpc-lcov#readme
changelog-type: markdown
hash: 4da209087eb9107a0d84881aacfa862889ba8bc43af91c204afaf0f001b55e80
test-bench-deps:
  base: '>=4.9 && <5'
  tasty-golden: -any
  tasty-discover: -any
  hpc-lcov: -any
  hpc: '>=0.6.0.3 && <0.7'
  containers: '>=0.5.7.1 && <0.7'
  tasty-hunit: -any
  tasty: -any
maintainer: Brandon Chinn <brandonchinn178@gmail.com>
synopsis: Convert HPC output into LCOV format
changelog: |
  # v1.1.1

  * Add support for GHC 9.4 + 9.6
  * Drop support for GHC < 8.10

  # v1.1.0

  * Drop support for GHC < 8.6

  # v1.0.1

  Bug fix:

  * Don't error if the `packages` field in `stack.yaml` doesn't exist

  # v1.0.0

  Initial release of `hpc-lcov`:

  * Generates LCOV files from HPC `.tix` files
  * Discovers `.tix` files generated by Stack test suites
  * Allows manually specifying a `.tix` file (useful for executables with coverage enabled)
basic-deps:
  path: '>=0.7.0 && <0.10'
  base: '>=4.9 && <5'
  unordered-containers: '>=0.2.13.0 && <0.3'
  text: '>=1.2.4.1 && <2.1'
  hpc-lcov: -any
  hpc: '>=0.6.0.3 && <0.7'
  process: '>=1.6.9.0 && <1.7'
  containers: '>=0.5.7.1 && <0.7'
  optparse-applicative: '>=0.15.1.0 && <0.19'
  aeson: '>=1.5.5.1 && <3'
  path-io: '>=1.6.2 && <2'
  yaml: '>=0.11.5.0 && <0.12'
all-versions:
- 1.0.0
- 1.0.1
- 1.1.0
- 1.1.1
author: Brandon Chinn <brandonchinn178@gmail.com>
latest: 1.1.1
description-type: markdown
description: |
  # hpc-lcov

  [![GitHub Actions](https://img.shields.io/github/actions/workflow/status/brandonchinn178/hpc-lcov/ci.yml?branch=main)](https://github.com/brandonchinn178/hpc-lcov/actions?query=branch%3Amain)
  [![codecov](https://codecov.io/gh/brandonchinn178/hpc-lcov/branch/main/graph/badge.svg?token=8TErU2ntw9)](https://codecov.io/gh/brandonchinn178/hpc-lcov)
  [![Hackage](https://img.shields.io/hackage/v/hpc-lcov)](https://hackage.haskell.org/package/hpc-lcov)

  Convert HPC output into `lcov.info` files that can be uploaded to coverage
  services, like [Codecov](https://codecov.io).

  ## Quickstart

  1. Download `hpc-lcov` from the releases page or install it from Hackage with your favorite package manager
  1. Run your tests with coverage enabled
      * `stack test --coverage`
      * Cabal is not yet supported (https://github.com/brandonchinn178/hpc-lcov/issues/3)
  1. Run `hpc-lcov`
  1. Upload the generated `lcov.info` file to your coverage service

  ## FAQs

  ### How do I convert coverage for an executable?

  Note: If you have both tests and executables, HPC will write module information to the same file. Because of this, you'll have to load the coverage for each separately, with a `stack clean` in between.

  1. Build a single executable with coverage enabled (e.g. `stack build :my-exe --coverage`)
  1. Run the executable
  1. This should generate a `.tix` file in the current directory
  1. Run the following, specifying the package that builds the executable:
      ```bash
      stack exec -- hpc-lcov --file my-exe.tix --main-package my-package
      ```

  ### How do I merge coverage files?

  1. Install LCOV (e.g. `brew install lcov`)
  1. Run

      ```bash
      lcov -a lcov1.info -a lcov2.info ... > lcov.info
      ```

  ## Resources

  * [LCOV format description](http://ltp.sourceforge.net/coverage/lcov/geninfo.1.php)
  * [More info on HPC](https://wiki.haskell.org/Haskell_program_coverage)
license-name: BSD-3-Clause
