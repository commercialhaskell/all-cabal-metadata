all-versions:
- 0.1.0.0
author: Yoshikuni Jujo
basic-deps:
  base: '>=4.7 && <5'
  bytestring: '>=0.12 && <0.13'
  bytestring-ft: '>=0.1 && <0.2'
  higher-order-open-union: '>=0.1 && <0.2'
  primitive: '>=0.9 && <0.10'
  tools-yj: '>=0.1 && <0.2'
  yaftee: '>=0.1 && <0.2'
  yaftee-basic-monads: '>=0.1 && <0.2'
  yaftee-conduit: '>=0.1 && <0.2'
  zlib-core: '>=0.1 && <0.2'
changelog: |
  # Changelog for `zlib-yaftee`

  All notable changes to this project will be documented in this file.

  The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
  and this project adheres to the
  [Haskell Package Versioning Policy](https://pvp.haskell.org/).

  ## Unreleased

  ## 0.1.0.0 - YYYY-MM-DD
changelog-type: markdown
description: "# zlib-yaftee\n\nsample1\n\n```Haskell\n{-# LANGUAGE ImportQualifiedPost
  #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE DataKinds #-}\n{-# OPTIONS_GHC
  -Wall -fno-warn-tabs #-}\n\nmodule Main (main) where\n\nimport Control.Monad\nimport
  Control.Monad.Yaftee.Eff qualified as Eff\nimport Control.Monad.Yaftee.Pipe qualified
  as Pp\nimport Control.Monad.Yaftee.Pipe.Tools qualified as PpT\nimport Control.Monad.Yaftee.Pipe.IO
  qualified as PpIO\nimport Control.Monad.Yaftee.Pipe.ByteString qualified as PpBS\nimport
  Control.Monad.Yaftee.Pipe.Zlib qualified as Z\nimport Control.Monad.Yaftee.Except
  qualified as Except\nimport Control.Monad.Yaftee.IO qualified as IO\nimport Data.ByteString.FingerTree
  qualified as BSF\nimport System.IO\nimport System.Environment\nimport Codec.Compression.Zlib.Constant.Core
  qualified as Z\nimport Codec.Compression.Zlib.Advanced.Core qualified as Z\n\nreadBufSize
  :: Int\nreadBufSize = 64 * 5\n\ninputBufSize, outputBufSize :: Int\ninputBufSize
  = 64 * 4\noutputBufSize = 64\n\nmain :: IO ()\nmain = do\n\tfp : _ <- getArgs; h
  <- openFile fp ReadMode\n\t(i, o) <- (,)\n\t\t<$> Z.cByteArrayMalloc inputBufSize\n\t\t<*>
  Z.cByteArrayMalloc outputBufSize\n\n\tvoid . Eff.runM . Except.run @Z.ReturnCode
  . Z.run @\"\" . Pp.run\n\t\t. (`Except.catch` IO.print @Z.ReturnCode) . void\n\t\t$
  PpBS.hGet readBufSize h Pp.=$=\n\t\t\tPpT.convert BSF.fromStrict Pp.=$=\n\t\t\tZ.inflate
  \"\" IO (Z.WindowBitsZlibAndGzip 15) i o Pp.=$=\n\t\t\tPpIO.print\n\n\tZ.cByteArrayFree
  i; Z.cByteArrayFree o; hClose h\n```\n\nsample2\n\n```Haskell\n{-# LANGUAGE ImportQualifiedPost
  #-}\n{-# LANGUAGE ScopedTypeVariables, TypeApplications #-}\n{-# LANGUAGE DataKinds
  #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# OPTIONS_GHC -Wall -fno-warn-tabs #-}\n\nmodule
  Main (main) where\n\nimport Control.Monad.Primitive\nimport Control.Monad.ST\nimport
  Control.Monad.Yaftee.Eff qualified as Eff\nimport Control.Monad.Yaftee.Pipe qualified
  as Pp\nimport Control.Monad.Yaftee.Pipe.Tools qualified as PpT\nimport Control.Monad.Yaftee.Pipe.ByteString
  qualified as PpBS\nimport Control.Monad.Yaftee.Pipe.Zlib qualified as Z\nimport
  Control.Monad.Yaftee.Except qualified as Except\nimport Data.ByteString qualified
  as BS\nimport Data.ByteString.FingerTree qualified as BSF\nimport System.Environment\nimport
  Codec.Compression.Zlib.Constant.Core qualified as Z\nimport Codec.Compression.Zlib.Advanced.Core
  qualified as Z\n\nreadBufSize :: Int\nreadBufSize = 64 * 5\n\ninputBufSize, outputBufSize
  :: Int\ninputBufSize = 64 * 4\noutputBufSize = 64\n\nmain :: IO ()\nmain = do\n\tfp
  : _ <- getArgs; cnt <- BS.readFile fp\n\teither print BS.putStr $ runST $ inflate
  cnt\n\ninflate :: forall m . PrimBase m =>\n\tBS.ByteString -> m (Either Z.ReturnCode
  BS.ByteString)\ninflate s = do\n\t(i, o) <- (,)\t<$> Z.cByteArrayMalloc inputBufSize\n\t\t\t<*>
  Z.cByteArrayMalloc outputBufSize\n\tr <- Eff.runM . Except.run @Z.ReturnCode . Z.run
  @\"\" . PpBS.to\n\t\t$ PpBS.from readBufSize s Pp.=$=\n\t\t\tPpT.convert BSF.fromStrict
  Pp.=$=\n\t\t\tZ.inflate \"\" m (Z.WindowBitsZlibAndGzip 15) i o Pp.=$=\n\t\t\tPpT.convert
  BSF.toStrict\n\tr <$ (Z.cByteArrayFree i >> Z.cByteArrayFree o)\n```\n\nsample3\n\n```Haskell\n{-#
  LANGUAGE ImportQualifiedPost #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE
  DataKinds #-}\n{-# OPTIONS_GHC -Wall -fno-warn-tabs #-}\n\nmodule Main (main) where\n\nimport
  Control.Monad\nimport Control.Monad.Yaftee.Eff qualified as Eff\nimport Control.Monad.Yaftee.Pipe
  qualified as Pp\nimport Control.Monad.Yaftee.Pipe.Tools qualified as PpT\nimport
  Control.Monad.Yaftee.Pipe.IO qualified as PpIO\nimport Control.Monad.Yaftee.Pipe.ByteString
  qualified as PpBS\nimport Control.Monad.Yaftee.Pipe.Zlib qualified as PpZ\nimport
  Control.Monad.Yaftee.Except qualified as Ex\nimport Control.Monad.Yaftee.IO qualified
  as IO\nimport Data.ByteString.FingerTree qualified as BSF\nimport System.IO\nimport
  System.Environment\nimport Codec.Compression.Zlib.Constant.Core qualified as Z\nimport
  Codec.Compression.Zlib.Advanced.Core qualified as Z\n\nmain :: IO ()\nmain = do\n\tfp
  : as <- getArgs; h <- openFile fp ReadMode\n\tlet\topt = case as of\n\t\t\t[] ->
  options $ Z.WindowBitsRaw 15\n\t\t\t[\"zlib\"] -> options $ Z.WindowBitsZlib 15\n\t\t\t[\"gzip\"]
  -> options $ Z.WindowBitsGzip 15\n\t\t\t_ -> error \"bad arguments\"\n\tib <- PpZ.cByteArrayMalloc
  64; ob <- PpZ.cByteArrayMalloc 64\n\t_ <- Eff.runM . Ex.run @Z.ReturnCode . PpZ.run
  @\"\" . Pp.run\n\t\t. (`Ex.catch` IO.print @Z.ReturnCode) . void $ PpBS.hGet 32
  h\n\t\t\tPp.=$= PpT.convert BSF.fromStrict\n\t\t\tPp.=$= PpZ.deflate \"\" IO opt
  ib ob\n\t\t\tPp.=$= PpIO.print\n\tPpZ.cByteArrayFree ib; PpZ.cByteArrayFree ob;
  hClose h\n\noptions :: Z.WindowBits -> PpZ.DeflateOptions\noptions wb = PpZ.DeflateOptions
  {\n\tPpZ.deflateOptionsCompressionLevel = Z.DefaultCompression,\n\tPpZ.deflateOptionsCompressionMethod
  = Z.Deflated,\n\tPpZ.deflateOptionsWindowBits = wb,\n\tPpZ.deflateOptionsMemLevel
  = Z.MemLevel 8,\n\tPpZ.deflateOptionsCompressionStrategy = Z.DefaultStrategy }\n```\n"
description-type: markdown
hash: a8d326c708f39228db82f52d41b7def01093a4dcc98409d813d3ca9bbbebd144
homepage: https://github.com/YoshikuniJujo/zlib-yaftee#readme
latest: 0.1.0.0
license-name: BSD-3-Clause
maintainer: yoshikuni.jujo@gmail.com
synopsis: Zlib wrapper built on Yaftee
test-bench-deps:
  base: '>=4.7 && <5'
  bytestring: '>=0.12 && <0.13'
  bytestring-ft: '>=0.1 && <0.2'
  higher-order-open-union: '>=0.1 && <0.2'
  primitive: '>=0.9 && <0.10'
  tools-yj: '>=0.1 && <0.2'
  yaftee: '>=0.1 && <0.2'
  yaftee-basic-monads: '>=0.1 && <0.2'
  yaftee-conduit: '>=0.1 && <0.2'
  zlib-core: '>=0.1 && <0.2'
  zlib-yaftee: '>=0'
