homepage: https://github.com/divarvel/biscuit-haskell#readme
changelog-type: markdown
hash: 640653caaeb6726bc608906fef7e9521c9404397aba240dd2ec291ae24731db7
test-bench-deps:
  warp: -any
  http-client: -any
  bytestring: -any
  biscuit-haskell: -any
  base: '>=4.7 && <5'
  time: -any
  servant-client: -any
  hspec: -any
  text: -any
  servant-client-core: -any
  servant-server: -any
  servant: -any
  biscuit-servant: -any
maintainer: clement@delafargue.name
synopsis: Servant support for the Biscuit security token
changelog: |
  # Changelog for biscuit-servant

  ## 0.1.1.0

  Initial release
basic-deps:
  bytestring: ^>=0.10
  wai: ^>=3.2
  biscuit-haskell: ^>=0.2
  base: '>=4.7 && <5'
  text: ^>=1.2
  servant-server: ^>=0.18
  mtl: ^>=2.2
all-versions:
- 0.1.1.0
- 0.2.0.0
author: Cl√©ment Delafargue
latest: 0.2.0.0
description-type: markdown
description: "<img src=\"https://raw.githubusercontent.com/divarvel/biscuit-haskell/main/assets/biscuit-logo.png\"
  align=right>\n\n# biscuit-servant \U0001F916 [![Hackage][hackage]][hackage-url]\n\n>
  **Servant combinators to enable biscuit validation in your API trees**\n\n## Usage\n\n```Haskell\ntype
  AppM = WithAuthorizer Handler\ntype API = RequireBiscuit :> ProtectedAPI\n\n-- /users\n--
  /users/:userId\ntype ProtectedAPI =\n  \"users\" :> ( Get '[JSON] [User]\n             :<|>
  Capture \"userId\" Int :> Get '[JSON] User\n             )\napp :: PublicKey ->
  Application\napp pk = serveWithContext @API Proxy (genBiscuitCtx pk) server\n\nserver
  :: Server API\nserver biscuit =\n  let handlers = userListHandler :<|> singleUserHandler\n
  \     handleAuth =\n        handleBiscuit biscuit\n        -- `allow if right(\"admin\");`
  will be the first policy\n        -- for every endpoint.\n        -- Policies added
  by endpoints (or sub-apis) will tried after this one.\n        . withPriorityAuthorizer
  [authorizer|allow if right(\"admin\");|]\n        -- `deny if true;` will be the
  last policy for every endpoint.\n        -- Policies added by endpoints (or sub-apis)
  will tried before this one.\n        . withFallbackAuthorizer [authorizer|deny if
  true;|]\n  in hoistServer @ProtectedAPI Proxy handleAuth handlers\n\nallUsers ::
  [User]\nallUsers = [ User 1 \"Danielle\" \"George\"\n           , User 2 \"Albert\"
  \"Einstein\"\n           ]\n\nuserListHandler :: AppM [User]\nuserListHandler =
  withAuthorizer [authorizer|allow if right(\"userList\")|]\n  $ pure allUsers\n\nsingleUserHandler
  :: Int -> AppM User\nsingleUserHandler uid =\n  withAuthorizer [authorizer|allow
  if right(\"getUser\", ${uid})|] $\n  let user = find (\\user -> userId user == uid)
  allUsers\n   in maybe (throwError error404) (\\user -> pure user) user\n```\n\n[Hackage]:
  https://img.shields.io/hackage/v/biscuit-haskell?color=purple&style=flat-square\n[hackage-url]:
  https://hackage.haskell.org/package/biscuit-servant\n"
license-name: BSD-3-Clause
