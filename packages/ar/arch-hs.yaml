homepage: https://github.com/berberman/arch-hs
changelog-type: markdown
hash: 97362e7f3571074fc60c6e5e8dbde3355c56b3f52098e69b5753a8674fa144ff
test-bench-deps: {}
maintainer: berberman <berberman@yandex.com>
synopsis: Distribute hackage packages to archlinux
changelog: "# Changelog\n\n`arch-hs` uses [PVP Versioning][1].\nThe changelog is available
  [on GitHub][2].\n\n## 0.7.1.0\n\n* Bump ghc version to 8.10.4\n\n* Fix some output
  formats\n\n## 0.7.0.0\n\n* Support dumping output of `arch-hs` to JSON\n\n* Support
  resolving setup dependencies in `arch-hs-diff`\n\n* Fix wrong concatenation direction
  of differentiating dependencies in `arch-hs-diff`\n\n* Replace `req` with [`arch-web`](https://github.com/berberman/arch-web)
  and `http-client`\n\n* Make `getLatestSHA256` become total function\n\n## 0.6.2.0\n\n*
  Use `Doc` to print prompt messages\n\n* Fix wrong line feeds in `arch-hs-diff`\n\n##
  0.6.1.0\n\n* Show dependens and makedepends in `arch-hs-diff` even if there is no
  difference between two target versions\n\n* Bump ghc version to 8.10.3\n\n* Fix
  an alignment error in `arch-hs-submit`\n\n## 0.6.0.0\n\n* Adopt [prettyprinter](https://hackage.haskell.org/package/prettyprinter)\n\n*
  Support resolving `pkgconfigDepends` and `extraLibs` using pacman files db\n\n*
  Support resolving custom-setup dependencies\n\n* Add an option to force `arch-hs`
  to run even if the target is in [community] \n\n* Adopt [Diff](https://hackage.haskell.org/package/Diff)
  in `arch-hs-diff` and `arch-hs-submit`\n\n* Fix the bug that `ghc` is missing in
  depends\n\n* Fix typo ([#35](https://github.com/berberman/arch-hs/pull/35))\n\n*
  Update dependencies ([#34](https://github.com/berberman/arch-hs/pull/34))\n\n##
  0.5.0.0\n\n* Add `TargetDisappearException` to complain if target is clearly not
  reachable\n\n* Warn abnormal dependencies\n\n* Clear trace file if is not empty\n\n*
  Collect test dependencies recursively\n\n* Drop meaningless `alpm_errno_t`\n\n*
  Update name preset ([#30](https://github.com/berberman/arch-hs/pull/30) [#32](https://github.com/berberman/arch-hs/pull/32))\n\n*
  Fix a typo ([#29](https://github.com/berberman/arch-hs/pull/29))\n\n## 0.4.0.0\n\n*
  [Alpm](https://www.archlinux.org/pacman/libalpm.3.html) support\n\n* Fix sub-libraries
  handling ([#22](https://github.com/berberman/arch-hs/issues/22))\n\n* Fix missing
  build tools ([#24](https://github.com/berberman/arch-hs/issues/24))\n\n* Fix flag
  comparison in diff ([#25](https://github.com/berberman/arch-hs/issues/25))\n\n*
  Fix pretty printing of flags\n\n* Update name preset ([#26](https://github.com/berberman/arch-hs/pull/26))\n\n##
  0.3.0.0\n\n* Update name preset\n\n* Add check in submit\n\n## 0.2.0.0\n\n* More
  accurate naming conversion between hackage representation and archlinux representation,
  according to [NAME_PRESET.json](https://github.com/berberman/arch-hs/blob/master/data/NAME_PRESET.json)\n\n*
  Clearer project structure\n\n* More reasonable exceptions\n\n* Provide versions
  of haskell packages in archlinux community\n\n* Add `arch-hs-submit` executable\n\n##
  0.1.1.0\n\n* Add uusi option\n\n## 0.1.0.0\n\n* Support sub-libraries ([#16](https://github.com/berberman/arch-hs/issues/16))\n\n*
  Split `arch-hs-uusi` into [`uusi`](https://github.com/berberman/uusi)\n\n* Better
  performance in dependency resolving\n\n* Fix recommended package order\n\n* Trace
  for dependency resolving\n\n* More reasonable PKGBUILD template ([#17](https://github.com/berberman/arch-hs/issues/16)
  [#18](https://github.com/berberman/arch-hs/issues/16) [#19](https://github.com/berberman/arch-hs/issues/16)
  [#20](https://github.com/berberman/arch-hs/issues/16))\n\n* Fix indentation of flags'
  pretty printing\n\n## 0.0.0.0\n\n* Initially created.\n\n[1]: https://pvp.haskell.org\n[2]:
  https://github.com/berberman/arch-hs/releases\n"
basic-deps:
  http-client: -any
  microlens-th: '>=0.4.3 && <0.5'
  bytestring: -any
  split: '>=0.2.3 && <0.3'
  Cabal: '>=3.2 && <3.5'
  base: '>=4.12 && <5'
  Diff: '>=0.4.0 && <0.5'
  servant-client: '>=0.18.2 && <0.19'
  text: -any
  megaparsec: '>=9.0.0 && <9.1'
  filepath: '>=1.4.2 && <1.5'
  conduit: '>=1.3.2 && <1.4'
  arch-hs: -any
  conduit-extra: '>=1.3.5 && <1.4'
  hackage-db: '>=2.1.0 && <2.2'
  containers: -any
  tar-conduit: '>=0.3.2 && <0.4'
  http-client-tls: -any
  arch-web: '>=0.1.0 && <0.2'
  polysemy: -any
  prettyprinter: '>=1.7.0 && <1.8'
  optparse-applicative: '>=0.16.0 && <0.17'
  deepseq: '>=1.4.4 && <1.5'
  algebraic-graphs: ==0.5.*
  microlens: '>=0.4.11 && <0.5'
  aeson: '>=1.5.4 && <1.6'
  template-haskell: '>=2.16.0 && <2.17'
  prettyprinter-ansi-terminal: '>=1.1.2 && <1.2'
  neat-interpolation: '>=0.5.1 && <0.6'
  directory: '>=1.3.6 && <1.4'
all-versions:
- 0.0.0.0
- 0.1.0.0
- 0.1.1.0
- 0.2.0.0
- 0.3.0.0
- 0.4.0.0
- 0.5.0.0
- 0.6.0.0
- 0.6.1.0
- 0.6.2.0
- 0.7.0.0
- 0.7.1.0
author: berberman
latest: 0.7.1.0
description-type: markdown
description: "# arch-hs\n\n[![Hackage](https://img.shields.io/hackage/v/arch-hs.svg?logo=haskell)](https://hackage.haskell.org/package/arch-hs)\n[![Dependency](https://img.shields.io/hackage-deps/v/arch-hs)](https://packdeps.haskellers.com/feed?needle=arch-hs)\n[![MIT
  license](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)\n\n| Env              |
  CI                                                                                                                        |\n|
  ---------------- | -------------------------------------------------------------------------------------------------------------------------
  |\n| pacman (-f alpm) | [![GitHub CI](https://github.com/berberman/arch-hs/workflows/CI/badge.svg)](https://github.com/berberman/arch-hs/actions)
  |\n| cabal-install    | [![Build Status](https://travis-ci.com/berberman/arch-hs.svg?branch=master)](https://travis-ci.com/berberman/arch-hs)
  \    |\n\nA program generating PKGBUILD for hackage packages. Special thanks to
  [felixonmars](https://github.com/felixonmars/).\n\n**Notice that `arch-hs` will
  always support only the latest GHC version used by Arch Linux.**\n\n\n## Introduction\n\nGiven
  the name of a package in hackage, `arch-hs` can generate PKGBUILD files, not only
  for the package\nwhose name is given, but also for all dependencies missing in [[community]](https://www.archlinux.org/packages/).\n`arch-hs`
  has a naive built-in dependency solver, which can fetch those dependencies and find
  out which are required to be packaged.\nDuring the dependency calculation, all version
  constraints will be discarded due to the arch haskell packaging strategy,\nthus
  there is no guarantee of dependencies' version consistency.\n\n## Prerequisite\n\n`arch-hs`
  is a PKGBUILD text file generator, which is not integrated with `pacman`(See [Alpm
  Support](#Alpm-Support)), depending on nothing than:\n\n* Pacman databases (`community.db`,
  `community.files`, `core.files`, and `extra.files`)\n\n* Hackage index tarball (`01-index.tar`,
  or `00-index.tar` previously) -- usually provided by `cabal-install`\n\n## Installation\n\n`arch-hs`
  is portable, which means it's not restricted to Arch Linux.\nHowever, `arch-hs`
  can use libalpm to load pacman database on Arch Linux,\nand if you want to run on
  other systems, you have to build it from source.\n\n### Install the latest release\n\n```\n#
  pacman -S arch-hs\n```\n\n`arch-hs` is available in [[community]](https://www.archlinux.org/packages/community/x86_64/arch-hs/),
  so you can install it using `pacman`.\n\n### Install the development version\n\n```\n#
  pacman -S arch-hs-git\n```\n\nThe `-git` version is available in [[archlinuxcn]](https://github.com/archlinuxcn/repo),
  following the latest git commit.\n\n## Build\n\n```\n$ git clone https://github.com/berberman/arch-hs\n```\n\nThen
  build it via stack or cabal.\n\n#### Stack\n```\n$ stack build\n```\n\n#### Cabal
  (dynamic)\n```\n$ cabal configure --disable-library-vanilla --enable-shared --enable-executable-dynamic
  --ghc-options=-dynamic \n$ cabal build\n```\n\n## Usage\n\nJust run `arch-hs` in
  command line with options and a target. Here is an example:\nwe will create the
  archlinux package of [gi-gdk](https://hackage.haskell.org/package/gi-gdk).\n\n<details
  open>\n<summary>\nOutput:\n</summary>\n\n```\n$ arch-hs -o ~/test --alpm gi-gdk
  \nⓘ Loading hackage from /home/berberman/.cabal/packages/hackage.haskell.org/01-index.tar\nⓘ
  Loading community.db from libalpm\nⓘ Start running...\nⓘ Solved:\nCabal                                       ✔
  [community]\nChasingBottoms                              ✔ [community]\nDiff                                        ✔
  [community]\nHUnit                                       ✔ [community]\nQuickCheck
  \                                 ✔ [community]\nStateVar                                    ✔
  [community]\nadjunctions                                 ✔ [community]\naeson                                       ✔
  [community]\nansi-terminal                               ✔ [community]\nansi-wl-pprint
  \                             ✔ [community]\nassoc                                       ✔
  [community]\nasync                                       ✔ [community]\nattoparsec
  \                                 ✔ [community]\nbase-compat                                 ✔
  [community]\nbase-compat-batteries                       ✔ [community]\nbase-orphans
  \                               ✔ [community]\nbase16-bytestring                           ✔
  [community]\nbase64-bytestring                           ✔ [community]\nbifunctors
  \                                 ✔ [community]\nbinary                                      ✔
  [community]\nblaze-builder                               ✔ [community]\nblaze-html
  \                                 ✔ [community]\nblaze-markup                                ✔
  [community]\nbytestring                                  ✔ [community]\nbytestring-handle
  \                          ✔ [community]\ncabal-doctest                               ✔
  [community]\ncall-stack                                  ✔ [community]\ncase-insensitive
  \                           ✔ [community]\ncharset                                     ✔
  [community]\nclock                                       ✔ [community]\ncode-page
  \                                  ✔ [community]\ncolour                                      ✔
  [community]\ncomonad                                     ✔ [community]\nconcurrent-output
  \                          ✔ [community]\nconduit                                     ✔
  [community]\nconduit-extra                               ✔ [community]\nconstraints
  \                                ✔ [community]\ncontainers                                  ✔
  [community]\ncontravariant                               ✔ [community]\ndata-default
  \                               ✔ [community]\ndata-default-instances-containers
  \          ✔ [community]\ndata-default-instances-dlist                ✔ [community]\ndata-default-instances-old-locale
  \          ✔ [community]\ndata-fix                                    ✔ [community]\ndeepseq
  \                                    ✔ [community]\ndirectory                                   ✔
  [community]\ndistributive                                ✔ [community]\ndlist                                       ✔
  [community]\ndoctest                                     ✔ [community]\nexceptions
  \                                 ✔ [community]\nfilepath                                    ✔
  [community]\nfingertree                                  ✔ [community]\nfoldl                                       ✔
  [community]\nfree                                        ✔ [community]\ngeneric-deriving
  \                           ✔ [community]\nghc                                         ✔
  [community]\nghc-boot                                    ✔ [community]\nghc-paths
  \                                  ✔ [community]\nghci                                        ✔
  [community]\ngi-cairo                                    ✔ [community]\ngi-gdk                                      ✘\n
  ├─Cabal (Setup)                            ✔ [community]\n ├─bytestring (Lib)                         ✔
  [community]\n ├─containers (Lib)                         ✔ [community]\n ├─gi-cairo
  (Lib, Setup)                    ✔ [community]\n ├─gi-gdkpixbuf (Lib, Setup)                ✘\n
  ├─gi-gio (Lib, Setup)                      ✘\n ├─gi-glib (Lib, Setup)                     ✘\n
  ├─gi-gobject (Lib, Setup)                  ✘\n ├─gi-pango (Lib, Setup)                    ✘\n
  ├─haskell-gi (Lib, Setup)                  ✔ [community]\n ├─haskell-gi-base (Lib)
  \                   ✔ [community]\n ├─haskell-gi-overloading (Lib)             ✔
  [community]\n ├─text (Lib)                               ✔ [community]\n └─transformers
  (Lib)                       ✔ [community]\ngi-gdkpixbuf                                ✘\n
  ├─Cabal (Setup)                            ✔ [community]\n ├─bytestring (Lib)                         ✔
  [community]\n ├─containers (Lib)                         ✔ [community]\n ├─gi-gio
  (Lib, Setup)                      ✘\n ├─gi-glib (Lib, Setup)                     ✘\n
  ├─gi-gobject (Lib, Setup)                  ✘\n ├─haskell-gi (Lib, Setup)                  ✔
  [community]\n ├─haskell-gi-base (Lib)                    ✔ [community]\n ├─haskell-gi-overloading
  (Lib)             ✔ [community]\n ├─text (Lib)                               ✔ [community]\n
  └─transformers (Lib)                       ✔ [community]\ngi-gio                                      ✘\n
  ├─Cabal (Setup)                            ✔ [community]\n ├─bytestring (Lib)                         ✔
  [community]\n ├─containers (Lib)                         ✔ [community]\n ├─gi-glib
  (Lib, Setup)                     ✘\n ├─gi-gobject (Lib, Setup)                  ✘\n
  ├─haskell-gi (Lib, Setup)                  ✔ [community]\n ├─haskell-gi-base (Lib)
  \                   ✔ [community]\n ├─haskell-gi-overloading (Lib)             ✔
  [community]\n ├─text (Lib)                               ✔ [community]\n └─transformers
  (Lib)                       ✔ [community]\ngi-glib                                     ✘\n
  ├─Cabal (Setup)                            ✔ [community]\n ├─bytestring (Lib)                         ✔
  [community]\n ├─containers (Lib)                         ✔ [community]\n ├─haskell-gi
  (Lib, Setup)                  ✔ [community]\n ├─haskell-gi-base (Lib)                    ✔
  [community]\n ├─haskell-gi-overloading (Lib)             ✔ [community]\n ├─text
  (Lib)                               ✔ [community]\n └─transformers (Lib)                       ✔
  [community]\ngi-gobject                                  ✘\n ├─Cabal (Setup)                            ✔
  [community]\n ├─bytestring (Lib)                         ✔ [community]\n ├─containers
  (Lib)                         ✔ [community]\n ├─gi-glib (Lib, Setup)                     ✘\n
  ├─haskell-gi (Lib, Setup)                  ✔ [community]\n ├─haskell-gi-base (Lib)
  \                   ✔ [community]\n ├─haskell-gi-overloading (Lib)             ✔
  [community]\n ├─text (Lib)                               ✔ [community]\n └─transformers
  (Lib)                       ✔ [community]\ngi-harfbuzz                                 ✘\n
  ├─Cabal (Setup)                            ✔ [community]\n ├─bytestring (Lib)                         ✔
  [community]\n ├─containers (Lib)                         ✔ [community]\n ├─gi-glib
  (Lib, Setup)                     ✘\n ├─gi-gobject (Lib, Setup)                  ✘\n
  ├─haskell-gi (Lib, Setup)                  ✔ [community]\n ├─haskell-gi-base (Lib)
  \                   ✔ [community]\n ├─haskell-gi-overloading (Lib)             ✔
  [community]\n ├─text (Lib)                               ✔ [community]\n └─transformers
  (Lib)                       ✔ [community]\ngi-pango                                    ✘\n
  ├─Cabal (Setup)                            ✔ [community]\n ├─bytestring (Lib)                         ✔
  [community]\n ├─containers (Lib)                         ✔ [community]\n ├─gi-glib
  (Lib, Setup)                     ✘\n ├─gi-gobject (Lib, Setup)                  ✘\n
  ├─gi-harfbuzz (Lib, Setup)                 ✘\n ├─haskell-gi (Lib, Setup)                  ✔
  [community]\n ├─haskell-gi-base (Lib)                    ✔ [community]\n ├─haskell-gi-overloading
  (Lib)             ✔ [community]\n ├─text (Lib)                               ✔ [community]\n
  └─transformers (Lib)                       ✔ [community]\nhashable                                    ✔
  [community]\nhashable-time                               ✔ [community]\nhaskell-gi
  \                                 ✔ [community]\nhaskell-gi-base                             ✔
  [community]\nhaskell-src-exts                            ✔ [community]\nhedgehog
  \                                   ✔ [community]\nhpc                                         ✔
  [community]\nhspec                                       ✔ [community]\nhspec-core
  \                                 ✔ [community]\nhspec-discover                              ✔
  [community]\nhspec-expectations                          ✔ [community]\nhspec-meta
  \                                 ✔ [community]\nindexed-traversable                         ✔
  [community]\ninteger-logarithms                          ✔ [community]\ninvariant
  \                                  ✔ [community]\nkan-extensions                              ✔
  [community]\nlens                                        ✔ [community]\nlibxml                                      ✔
  [community]\nlifted-async                                ✔ [community]\nlifted-base
  \                                ✔ [community]\nlogging-facade                              ✔
  [community]\nlogict                                      ✔ [community]\nmath-functions
  \                             ✔ [community]\nmmorph                                      ✔
  [community]\nmockery                                     ✔ [community]\nmonad-control
  \                              ✔ [community]\nmono-traversable                            ✔
  [community]\nmtl                                         ✔ [community]\nmwc-random
  \                                 ✔ [community]\nnanospec                                    ✔
  [community]\nnetwork                                     ✔ [community]\noptparse-applicative
  \                       ✔ [community]\nparallel                                    ✔
  [community]\nparsec                                      ✔ [community]\nparsers
  \                                    ✔ [community]\npcre-light                                  ✔
  [community]\npgp-wordlist                                ✔ [community]\npretty                                      ✔
  [community]\npretty-show                                 ✔ [community]\nprettyprinter
  \                              ✔ [community]\nprettyprinter-ansi-terminal                 ✔
  [community]\nprimitive                                   ✔ [community]\nprocess
  \                                    ✔ [community]\nprofunctors                                 ✔
  [community]\nquickcheck-classes-base                     ✔ [community]\nquickcheck-instances
  \                       ✔ [community]\nquickcheck-io                               ✔
  [community]\nquickcheck-unicode                          ✔ [community]\nrandom                                      ✔
  [community]\nreducers                                    ✔ [community]\nreflection
  \                                 ✔ [community]\nregex-base                                  ✔
  [community]\nregex-posix                                 ✔ [community]\nregex-tdfa
  \                                 ✔ [community]\nresourcet                                   ✔
  [community]\nsafe                                        ✔ [community]\nscientific
  \                                 ✔ [community]\nsemigroupoids                               ✔
  [community]\nsetenv                                      ✔ [community]\nsilently
  \                                   ✔ [community]\nsmallcheck                                  ✔
  [community]\nsplit                                       ✔ [community]\nsplitmix
  \                                   ✔ [community]\nstm                                         ✔
  [community]\nstreaming-commons                           ✔ [community]\nstrict                                      ✔
  [community]\nstringbuilder                               ✔ [community]\nsyb                                         ✔
  [community]\ntagged                                      ✔ [community]\ntar                                         ✔
  [community]\ntasty                                       ✔ [community]\ntasty-ant-xml
  \                              ✔ [community]\ntasty-expected-failure                      ✔
  [community]\ntasty-golden                                ✔ [community]\ntasty-hedgehog
  \                             ✔ [community]\ntasty-hunit                                 ✔
  [community]\ntasty-quickcheck                            ✔ [community]\ntasty-smallcheck
  \                           ✔ [community]\ntasty-th                                    ✔
  [community]\ntemplate-haskell                            ✔ [community]\ntemporary
  \                                  ✔ [community]\nterminal-size                               ✔
  [community]\ntest-framework                              ✔ [community]\ntest-framework-hunit
  \                       ✔ [community]\ntest-framework-quickcheck2                  ✔
  [community]\ntext                                        ✔ [community]\ntf-random
  \                                  ✔ [community]\nth-abstraction                              ✔
  [community]\nthese                                       ✔ [community]\ntime                                        ✔
  [community]\ntime-compat                                 ✔ [community]\ntransformers-base
  \                          ✔ [community]\ntransformers-compat                         ✔
  [community]\ntree-diff                                   ✔ [community]\ntrifecta
  \                                   ✔ [community]\ntyped-process                               ✔
  [community]\nunix                                        ✔ [community]\nunix-compat
  \                                ✔ [community]\nunliftio                                    ✔
  [community]\nunliftio-core                               ✔ [community]\nunordered-containers
  \                       ✔ [community]\nutf8-string                                 ✔
  [community]\nuuid-types                                  ✔ [community]\nvector                                      ✔
  [community]\nvector-algorithms                           ✔ [community]\nvector-th-unbox
  \                            ✔ [community]\nwcwidth                                     ✔
  [community]\nwl-pprint-annotated                         ✔ [community]\nxdg-basedir
  \                                ✔ [community]\nxml                                         ✔
  [community]\nxml-conduit                                 ✔ [community]\nxml-types
  \                                  ✔ [community]\nzlib                                        ✔
  [community]\narray                                       ✔ [community]\ntransformers
  \                               ✔ [community]\nsemigroups                                  ✔
  [community]\nvoid                                        ✔ [community]\ninteger-gmp
  \                                ✔ [community]\nhsc2hs                                      ✔
  [community]\ntype-equality                               ✔ [community]\ndata-default-class
  \                         ✔ [community]\nold-locale                                  ✔
  [community]\nghc-boot-th                                 ✔ [community]\nterminfo
  \                                   ✔ [community]\nhaskell-gi-overloading                      ✔
  [community]\nhappy                                       ✔ [community]\nerf                                         ✔
  [community]\nsimple-reflect                              ✔ [community]\nhaskell-lexer
  \                              ✔ [community]\nunbounded-delays                            ✔
  [community]\nhostname                                    ✔ [community]\nextensible-exceptions
  \                      ✔ [community]\n\nⓘ Recommended package order:\n1. gi-glib\n2.
  gi-gobject\n3. gi-harfbuzz\n4. gi-pango\n5. gi-gio\n6. gi-gdkpixbuf\n7. gi-gdk\n\nⓘ
  Detected pkgconfig or extraLib from target(s):\ngi-gdk:      gtk4.pc\ngi-gdkpixbuf:gdk-pixbuf-2.0.pc\ngi-gio:
  \     gio-2.0.pc\ngi-glib:     glib-2.0.pc\ngi-gobject:  gobject-2.0.pc\ngi-harfbuzz:
  harfbuzz.pc, harfbuzz-gobject.pc\ngi-pango:    pango.pc\n\nⓘ Now finding corresponding
  system package(s) using files db:\nⓘ Loading [core] files from libalpm\nⓘ Loading
  [extra] files from libalpm\nⓘ Done:\ngtk4.pc               ⇒   gtk4\ngdk-pixbuf-2.0.pc
  \    ⇒   gdk-pixbuf2\ngio-2.0.pc            ⇒   glib2\nglib-2.0.pc           ⇒   glib2\ngobject-2.0.pc
  \       ⇒   glib2\nharfbuzz.pc           ⇒   harfbuzz\nharfbuzz-gobject.pc   ⇒   harfbuzz\npango.pc
  \             ⇒   pango\n\nⓘ Write file: /home/berberman/test/haskell-gi-gdk/PKGBUILD\nⓘ
  Write file: /home/berberman/test/haskell-gi-gdkpixbuf/PKGBUILD\nⓘ Write file: /home/berberman/test/haskell-gi-gio/PKGBUILD\nⓘ
  Write file: /home/berberman/test/haskell-gi-glib/PKGBUILD\nⓘ Write file: /home/berberman/test/haskell-gi-gobject/PKGBUILD\nⓘ
  Write file: /home/berberman/test/haskell-gi-harfbuzz/PKGBUILD\nⓘ Write file: /home/berberman/test/haskell-gi-pango/PKGBUILD\n✔
  Success!\n```\n</details>\n\nThis output tells us that in order to package `gi-gdk`,
  we must package its dependencies\nlisted in package order, which are not present
  in [community] repo. Particularly, `gi-gdk`\nrequires external system dependencies,
  so `arch-hs` can map them to system packages using files db.\n\n```\n$ tree ~/test\n/home/berberman/test\n├──
  haskell-gi-gdk\n│   └── PKGBUILD\n├── haskell-gi-gdkpixbuf\n│   └── PKGBUILD\n├──
  haskell-gi-gio\n│   └── PKGBUILD\n├── haskell-gi-glib\n│   └── PKGBUILD\n├── haskell-gi-gobject\n│
  \  └── PKGBUILD\n├── haskell-gi-harfbuzz\n│   └── PKGBUILD\n└── haskell-gi-pango\n
  \   └── PKGBUILD\n```\n\n`arch-hs` generates PKGBUILD for each package. Let's see
  what we have in `./haskell-gi-harfbuzz/PKGBUILD`:\n\n``` bash\n# This file was generated
  by https://github.com/berberman/arch-hs, please check it manually.\n# Maintainer:
  Your Name <youremail@domain.com>\n\n_hkgname=gi-harfbuzz\npkgname=haskell-gi-harfbuzz\npkgver=0.0.3\npkgrel=1\npkgdesc=\"HarfBuzz
  bindings\"\nurl=\"https://github.com/haskell-gi/haskell-gi\"\nlicense=(\"LGPL2.1\")\narch=('x86_64')\ndepends=('ghc-libs'
  'haskell-gi-glib' 'haskell-gi-gobject' 'haskell-gi' 'haskell-gi-base' 'haskell-gi-overloading'
  'harfbuzz')\nmakedepends=('ghc')\nsource=(\"https://hackage.haskell.org/packages/archive/$_hkgname/$pkgver/$_hkgname-$pkgver.tar.gz\")\nsha256sums=('5f61c7b07427d0b77f867c3bc560043239c6184f98921295ce28fc8c9ce257e5')\n\nbuild()
  {\n  cd $_hkgname-$pkgver\n\n  runhaskell Setup configure -O --enable-shared --enable-executable-dynamic
  --disable-library-vanilla \\\n    --prefix=/usr --docdir=/usr/share/doc/$pkgname
  --enable-tests \\\n    --dynlibdir=/usr/lib --libsubdir=\\$compiler/site-local/\\$pkgid
  \\\n    --ghc-option=-optl-Wl\\,-z\\,relro\\,-z\\,now \\\n    --ghc-option='-pie'\n\n
  \ runhaskell Setup build\n  runhaskell Setup register --gen-script\n  runhaskell
  Setup unregister --gen-script\n  sed -i -r -e \"s|ghc-pkg.*update[^ ]* |&'--force'
  |\" register.sh\n  sed -i -r -e \"s|ghc-pkg.*unregister[^ ]* |&'--force' |\" unregister.sh\n}\n\npackage()
  {\n  cd $_hkgname-$pkgver\n\n  install -D -m744 register.sh \"$pkgdir\"/usr/share/haskell/register/$pkgname.sh\n
  \ install -D -m744 unregister.sh \"$pkgdir\"/usr/share/haskell/unregister/$pkgname.sh\n
  \ runhaskell Setup copy --destdir=\"$pkgdir\"\n  install -D -m644 LICENSE -t \"$pkgdir\"/usr/share/licenses/$pkgname/\n
  \ rm -f \"$pkgdir\"/usr/share/doc/$pkgname/LICENSE\n}\n```\n\n`arch-hs` will collect
  the information from hackage db, and apply it into a fixed template after some processing
  steps\nincluding renaming, matching license, and filling out dependencies etc.\nHowever,
  packaging haven't been done so far.\n`arch-hs` can't guarantee that this package
  can be built by ghc with the latest dependencies;\nhence some patchs may be required
  in `prepare()`, such as [uusi](#Uusi).\n\n\n## Options\n\n### Output\n\n```\n$ arch-hs
  -o ~/test TARGET\n```\n\nUsing `-o` can generate a series of PKGBUILD including
  `TARGET` with its dependencies into the output dir. If you don't pass it, only dependency
  calculation will occur.\n\n### Flag Assignments\n```\n$ arch-hs -f TARGET:FLAG_A:true
  TARGET\n```\n\nUsing `-f` can pass flags, which may affect the results of resolving.
  \ \n\n### AUR Searching\n\n```\n$ arch-hs -a TARGET\n```\n\nWith `-a`, `arch-hs`
  will regard AUR as another package provider, and it will try to search missing packages
  in AUR as well.\n\n### Skipping Components\n\n```\n$ arch-hs -s COMPONENT_A TARGET\n```\n\nUsing
  `-s` can force skip runnable components in dependency resolving.\nThis is useful
  when a package doesn't provide flag to disable its runnables, which will be built
  by default but are trivial in system level packaging.\nNotice that this only makes
  sense in the lifetime of `arch-hs`, whereas generated PKGBUILD and actual build
  processes will not be affected.\n\n### Extra Cabal Files\n\n```\n$ arch-hs -e ~/TARGET/TARGET.cabal
  TARGET\n```\n\n**For Testing Purposes Only**\n\nUsing `-e` can include extra `.cabal`
  files as supplementary. Useful when the `TARGET` hasn't been released to hackage.\n\n###
  Trace\n\n```\n$ arch-hs --trace TARGET\n```\n\nWith `--trace`, `arch-hs` can print
  the process of dependency resolving into stdout.\n\n```\n$ arch-hs --trace-file
  foo.log TARGET\n```\n\nSimilar to `--trace`, but the log will be written into a
  file.\n\n### Uusi\n\n```\n$ arch-hs -o ~/test --uusi TARGET\n```\n\nWith `--uusi`,
  `arch-hs` will generate following snippet for each package:\n\n```bash\nprepare()
  {\n  uusi $_hkgname-$pkgver/$_hkgname.cabal\n}\n```\n\nSee [uusi](https://hackage.haskell.org/package/uusi)
  for details.\n\n### Alpm\n\n```\n$ arch-hs --alpm TARGET\n```\n\nSee [Alpm Support](#Alpm-Support).\n\n###
  Force\n\n```\n$ arch-hs --force TARGET\n```\n\nWith `--force`, `arch-hs` will try
  to package even if the target is provided.\n\n### Json\n\n```\n$ arch-hs --json
  ./output.json TARGET\n```\n\nWith `--json`, `arch-hs` will dump information presented
  in stdout to file as JSON format, including:\n  * abnormal dependencies\n  * solved
  packages\n  * recommended package order\n  * system dependencies\n  * flags\n\n##
  [Name preset](https://github.com/berberman/arch-hs/blob/master/data/NAME_PRESET.json)\n\nTo
  distribute a haskell package to archlinux, the name of package should be changed
  according to the naming convention:\n\n* for haskell libraries, their names must
  have `haskell-` prefix\n\n* for programs, it depends on circumstances\n\n* names
  should always be in lower case\n\nHowever, it's not enough to prefix the string
  with `haskell-` and transform to lower case; in some special situations, the hackage
  name\nmay have `haskell-` prefix already, or the case is irregular, thus we have
  to a name preset manually. Once a package distributed to archlinux,\nwhose name
  conform to above-mentioned situation, the name preset should be upgraded correspondingly.\n\n##
  Diff\n\n`arch-hs` also provides a component called `arch-hs-diff`. `arch-hs-diff`
  can show the differences of package description between two versions of a package,\nand
  remind us if some required packages in community repo can't satisfy the version
  constraints, or they are non-existent.\nThis is useful in the subsequent maintenance
  of a package. For example:\n\n```\n$ arch-hs-diff --alpm comonad 5.0.6 5.0.7\nⓘ
  Loading community.db from libalpm\nⓘ Start running...\nⓘ Downloading cabal file
  from https://hackage.haskell.org/package/comonad-5.0.6/revision/0.cabal...\nⓘ Downloading
  cabal file from https://hackage.haskell.org/package/comonad-5.0.7/revision/0.cabal...\nPackage:
  comonad\nVersion: 5.0.6  ⇒  5.0.7\nSynopsis: Comonads\nURL: http://github.com/ekmett/comonad/\nDepends:\n
  \ base  >=4 && <5\n  containers  >=0.3 && <0.7\n  distributive  >=0.2.2 && <1\n
  \ tagged  >=0.7 && <1\n  transformers  >=0.2 && <0.6\n  transformers-compat  >=0.3
  && <1\n--------------------------------------\n  base  >=4 && <5\n  containers  >=0.3
  && <0.7\n  distributive  >=0.2.2 && <1\n  indexed-traversable  >=0.1 && <0.2\n  tagged
  \ >=0.7 && <1\n  transformers  >=0.2 && <0.6\n  transformers-compat  >=0.3 && <1\n
  \nMakeDepends:\n  base  -any\n  doctest  >=0.11.1 && <0.17\n--------------------------------------\n
  \ base  -any\n  doctest  >=0.11.1 && <0.18\n\"doctest\" is required to be in range
  (>=0.11.1 && <0.17), but [community] provides (0.17). \nFlags:\n  comonad\n    ⚐
  test-doctests:\n        description:\n          \n        default: True\n        isManual:
  True\n    ⚐ containers:\n        description:\n          You can disable the use
  of the `containers` package using `-f-containers`.\n\n          Disabing this is
  an unsupported configuration, but it may be useful for accelerating builds in sandboxes
  for expert users.\n        default: True\n        isManual: True\n    ⚐ distributive:\n
  \       description:\n          You can disable the use of the `distributive` package
  using `-f-distributive`.\n\n          Disabling this is an unsupported configuration,
  but it may be useful for accelerating builds in sandboxes for expert users.\n\n
  \         If disabled we will not supply instances of `Distributive`\n\n        default:
  True\n        isManual: True\n--------------------------------------\n  comonad\n
  \   ⚐ test-doctests:\n        description:\n          \n        default: True\n
  \       isManual: True\n    ⚐ containers:\n        description:\n          You can
  disable the use of the `containers` package using `-f-containers`.\n\n          Disabing
  this is an unsupported configuration, but it may be useful for accelerating builds
  in sandboxes for expert users.\n        default: True\n        isManual: True\n
  \   ⚐ distributive:\n        description:\n          You can disable the use of
  the `distributive` package using `-f-distributive`.\n\n          Disabling this
  is an unsupported configuration, but it may be useful for accelerating builds in
  sandboxes for expert users.\n\n          If disabled we will not supply instances
  of `Distributive`\n\n        default: True\n        isManual: True\n    ⚐ indexed-traversable:\n
  \       description:\n          You can disable the use of the `indexed-traversable`
  package using `-f-indexed-traversable`.\n\n          Disabling this is an unsupported
  configuration, but it may be useful for accelerating builds in sandboxes for expert
  users.\n\n          If disabled we will not supply instances of `FunctorWithIndex`\n\n
  \       default: True\n        isManual: True\n✔ Success!\n```\n\n`arch-hs-diff`
  does not require hackage db, it downloads cabal files from hackage server instead.
  \n\n## Submit\n\nFor hackage distribution maintainers only.\n\n## Limitations\n\n*
  `arch-hs` will run into error, if solved targets contain cycle. Indeed, circular
  dependency lies ubiquitously in hackage because of tests,\nbut basic cycles are
  resolved manually in [community] by maintainers. So after the provider simplification,
  `arch-hs` can eliminate these cycles.\nNevertheless, if the target introduces new
  cycle or it dependens on a package in an unknown cycle, `arch-hs` will throw `CyclicExist`
  exception.\n\n* `arch-hs` is not able to handle with complicated situations: the
  libraries of a package partially exist in hackage, some libraries include external
  sources, etc. \n\n* `arch-hs`'s functionality is limited to dependency processing,
  whereas necessary procedures like\nfile patches, version range processes, etc. They
  need to be done manually, so **DO NOT** give too much trust in generated PKGBUILD
  files.\n\n## Alpm Support\n\n[alpm](https://www.archlinux.org/pacman/libalpm.3.html)
  is Arch Linux Package Management library.\nWhen running on Arch Linux, loading `community.db`
  and files dbs through this library is slightly faster than using the internal parser
  of `arch-hs`.\nThus, `arch-hs` provides a flag `alpm` to enable this feature:\n\n```\ncabal
  build -f alpm\n```\n\nThis flag is enabled by default in `arch-hs` Arch Linux package.\nCompiled
  with `alpm`, `arch-hs` can accept runtime flag `--alpm`.\n**That said, if you want
  to use alpm to boost `arch-hs`, you need compile `arch-hs` with cabal flag `alpm`,
  and pass `--aplm` to `arch-hs` when running.**\n> When `alpm` is enabled, `arch-hs`
  will lose the capability of specifying the path of `community.db` and directory
  of files db.\n\n\n## Contributing\n\nIssues and PRs are always welcome. **\\_(:з」∠)\\_**\n"
license-name: MIT
