homepage: https://github.com/ymherklotz/verismith#readme
changelog-type: ''
hash: 5f542ad6c2050b9e7f712d86a59b3f2bee70a48efc4e5ce3e0dda18f8b00cafe
test-bench-deps:
  shakespeare: ! '>=2 && <2.1'
  base: ==4.*
  tasty-hedgehog: ! '>=1.0 && <1.1'
  text: ! '>=1.2 && <1.3'
  criterion: ! '>=1.5.5 && <1.6'
  verismith: -any
  hedgehog: ! '>=1.0 && <1.2'
  parsec: ! '>=3.1 && <3.2'
  lens: ! '>=4.16.1 && <4.18'
  fgl: ! '>=5.6 && <5.8'
  tasty-hunit: ! '>=0.10 && <0.11'
  tasty: ! '>=1.0.1.1 && <1.3'
maintainer: yann [at] yannherklotz [dot] com
synopsis: Random verilog generation and simulator testing.
changelog: ''
basic-deps:
  shakespeare: ! '>=2 && <2.1'
  exceptions: ! '>=0.10.0 && <0.11'
  shelly: ! '>=1.8.0 && <1.9'
  bytestring: ! '>=0.10 && <0.11'
  base: ! '>=4.7 && <5'
  time: ! '>=1.8.0.2 && <1.9'
  unordered-containers: ! '>=0.2.10 && <0.3'
  text: ! '>=1.2 && <1.3'
  monad-control: ! '>=1.0.2 && <1.1'
  filepath: ! '>=1.4.2 && <1.5'
  gitrev: ! '>=1.3.1 && <1.4'
  verismith: -any
  hedgehog: ! '>=1.0 && <1.2'
  lifted-base: ! '>=0.2.3 && <0.3'
  parsec: ! '>=3.1 && <3.2'
  array: ! '>=0.5 && <0.6'
  memory: ! '>=0.14 && <0.15'
  lens: ! '>=4.16.1 && <4.18'
  binary: ! '>=0.8.5.1 && <0.9'
  fgl-visualize: ! '>=0.1 && <0.2'
  fgl: ! '>=5.6 && <5.8'
  cryptonite: ! '>=0.25 && <0.26'
  statistics: ! '>=0.14.0.2 && <0.16'
  blaze-html: ! '>=0.9.0.1 && <0.10'
  transformers-base: ! '>=0.4.5 && <0.5'
  prettyprinter: ! '>=1.2.0.1 && <1.3'
  transformers: ! '>=0.5 && <0.6'
  optparse-applicative: ! '>=0.14 && <0.15'
  random: ! '>=1.1 && <1.2'
  deepseq: ! '>=1.4.3.0 && <1.5'
  recursion-schemes: ! '>=5.0.2 && <5.2'
  DRBG: ! '>=0.5 && <0.6'
  template-haskell: ! '>=2.13.0 && <2.15'
  vector: ! '>=0.12.0.1 && <0.13'
  tomland: ! '>=1.0 && <1.2'
all-versions:
- 0.4.0.0
author: Yann Herklotz
latest: 0.4.0.0
description-type: markdown
description: "# Verismith [![Build Status](https://travis-ci.com/ymherklotz/verismith.svg?token=qfBKKGwxeWkjDsy7e16x&branch=master)](https://travis-ci.com/ymherklotz/verismith)\n\nVerilog
  Fuzzer to test the major verilog compilers by generating random, valid\nand deterministic
  Verilog. There is a\n[presentation](https://yannherklotz.com/docs/presentation.pdf)
  about Verismith\nand a [thesis](https://yannherklotz.com/docs/thesis.pdf) which
  goes over all the\ndetails of the implementation and results that were found.\n\nIt
  currently supports the following synthesis tools:\n\n- [Yosys](http://www.clifford.at/yosys/)\n-
  [Xst](https://www.xilinx.com/support/documentation/sw_manuals/xilinx11/ise_c_using_xst_for_synthesis.htm)\n-
  [Vivado](https://www.xilinx.com/products/design-tools/ise-design-suite.html)\n-
  [Quartus](https://www.intel.com/content/www/us/en/programmable/downloads/download-center.html)\n\nand
  the following simulator:\n\n- [Icarus Verilog](http://iverilog.icarus.com)\n\n##
  Supported Verilog Constructs\n\nThe fuzzer generates combinational and behavioural
  Verilog to test the various\ntools. The most notable constructs that are supported
  and generated are the\nfollowing:\n\n- module definitions with parameter definitions,
  inputs and outputs\n- module items, such as instantiations, continuous assignment,
  always blocks,\n  initial blocks, parameter and local parameter declarations\n-
  most expressions, for example concatenation, arithmetic operations, ternary\n    conditional
  operator\n- behavioural code in sequential always blocks\n- behavioural control
  flow such as if-else and for loops\n- declaration of wires and variables of any
  size, signed or unsigned\n- bit selection from wires and variables\n\n## Reported
  bugs\n\n21 bugs were found in total over the course of a month. 8 of those bugs
  were\nreported and 3 were fixed.\n\n### Yosys\n\n| Type          | Issue                                                      |
  Confirmed | Fixed |\n|---------------|------------------------------------------------------------|-----------|-------|\n|
  Mis-synthesis | [Issue 1243](https://github.com/YosysHQ/yosys/issues/1243) | ✓         |
  ✓     |\n| Mis-synthesis | [Issue 1047](https://github.com/YosysHQ/yosys/issues/1047)
  | ✓         | ✓     |\n| Mis-synthesis | [Issue 997](https://github.com/YosysHQ/yosys/issues/997)
  \  | ✓         | ✓     |\n| Crash         | [Issue 993](https://github.com/YosysHQ/yosys/issues/993)
  \  | ✓         | ✓     |\n\n### Vivado\n\n| Type          | Issue                                                                                                                               |
  Confirmed | Fixed |\n|---------------|-------------------------------------------------------------------------------------------------------------------------------------|-----------|-------|\n|
  Crash         | [Forum 981787](https://forums.xilinx.com/t5/Synthesis/Vivado-2019-1-Verilog-If-statement-nesting-crash/td-p/981787)
  \                | ✓         | \U00010102     |\n| Crash         | [Forum 981136](https://forums.xilinx.com/t5/Synthesis/Vivado-2018-3-synthesis-crash/td-p/981136)
  \                                   | ✓         | \U00010102     |\n| Mis-synthesis
  | [Forum 981789](https://forums.xilinx.com/t5/Synthesis/Vivado-2019-1-Unsigned-bit-extension-in-if-statement/td-p/981789)
  \            | ✓         | \U00010102     |\n| Mis-synthesis | [Forum 982518](https://forums.xilinx.com/t5/Synthesis/Vivado-2019-1-Signed-with-shift-in-condition-synthesis-mistmatch/td-p/982518)
  | ✓         | \U00010102     |\n| Mis-synthesis | [Forum 982419](https://forums.xilinx.com/t5/Synthesis/Vivado-2019-1-Bit-selection-synthesis-mismatch/td-p/982419)
  \                  | ✓         | \U00010102     |\n\n## Build the Fuzzer\n\nThe
  fuzzer now supports building with [nix](https://nixos.org/nix/manual/),\nwhich pulls
  in all the extra dependencies that are needed to build the\nproject. The main files
  and their functions are described below:\n\n- `default.nix`: describes the main
  Haskell package and it's dependencies that\n  have to be pulled in.\n- `shell.nix`:
  describes how to set up a shell with `nix-shell` which has all\n  the needed dependencies
  present.\n- `release.nix`: passes the versions of the packages that should be used
  to the\n  description of the fuzzer in `default.nix`, which also overrides some\n
  \ dependencies so that everything builds nicely. The exact versions of the\n  packages
  that should be overridden are in [nix](/nix).\n\nIt may be possible to build it
  purely with\n[cabal-install](https://hackage.haskell.org/package/cabal-install),
  however\nit may not have all the right versions of the dependencies that are needed.\n\nInstead,
  stack could be used and the `stack.yaml` file could contain the\noverrides that
  are used by nix.\n\n### Build with nix\n\nNix build is completely supported, therefore
  if nix is installed, building the\nproject is as simple as\n\n``` shell\nnix-build
  release.nix\n```\n\nIf one wants to work in the project with all the right dependencies
  loaded, one\ncan use\n\n``` shell\nnix-shell\n```\n\n### Build with cabal and nix\n\nAfter
  entering a development environment with `nix-shell`, the project can\nsafely be
  built with `cabal-install`.\n\n``` shell\ncabal v2-configure\ncabal v2-build\n```\n\nThis
  should not have to download any extra dependencies and just have to build\nthe actual
  project itself.\n\n## Configuration\n\nVerismith can be configured using a [TOML](https://github.com/toml-lang/toml)\nfile.
  There are four main sections in the configuration file, an example can be\nseen
  [here](/examples/config.toml).\n\n### Information section \n\nContains information
  about the command line tool being used, such as the hash of\nthe commit it was compiled
  with and the version of the tool. The tool then\nverifies that these match the current
  configuration, and will emit a warning if\nthey do not. This ensures that if one
  wants a deterministic run and is therefore\npassing a seed to the generation, that
  it will always give the same\nresult. Different versions might change some aspects
  of the Verilog generation,\nwhich would affect how a seed would generate Verilog.\n\n###
  Probability section \n\nProvides a way to assign frequency values to each of the
  nodes in the\nAST. During the state-based generation, each node is chosen randomly
  based on\nthose probabilities. This provides a simple way to drastically change
  the\nVerilog that is generated, by changing how often a construct is chosen or by
  not\ngenerating a construct at all.\n\n### Property section \n\nChanges properties
  of the generated Verilog code, such as the size of the\noutput, maximum statement
  or module depth and sampling method of Verilog\nprograms. This section also allows
  a seed to be specified, which would mean that\nonly that particular seed will be
  used in the fuzz run. This is extremely useful\nwhen wanting to replay a specific
  failure and the output is missing.\n\n### Synthesiser section \n\nAccepts a list
  of synthesisers which will be fuzzed. These have to first be\ndefined in the code
  and implement the required interface. They can then be\nconfigured by having a name
  assigned to them and the name of the output Verilog\nfile. By each having a different
  name, multiple instances of the same\nsynthesiser can be included in a fuzz run.
  The instances might differ in the\noptimisations that are performed, or in the version
  of the synthesiser.\n\n## Benchmark Results\n\nCurrent benchmark results to compare
  against.\n\n``` text\nbenchmarking generation/default\ntime                 65.16
  ms   (42.67 ms .. 84.90 ms)\n                     0.837 R²   (0.722 R² .. 0.966
  R²)\nmean                 82.87 ms   (71.13 ms .. 105.9 ms)\nstd dev              27.59
  ms   (15.80 ms .. 42.35 ms)\nvariance introduced by outliers: 90% (severely inflated)\n\nbenchmarking
  generation/depth\ntime                 860.8 ms   (2.031 ms .. 1.488 s)\n                     0.900
  R²   (0.668 R² .. 1.000 R²)\nmean                 483.9 ms   (254.1 ms .. 647.6
  ms)\nstd dev              224.4 ms   (100.8 ms .. 283.5 ms)\nvariance introduced
  by outliers: 74% (severely inflated)\n\nbenchmarking generation/size\ntime                 541.1
  ms   (-749.1 ms .. 1.263 s)\n                     0.568 R²   (0.005 R² .. 1.000
  R²)\nmean                 698.8 ms   (498.2 ms .. 897.5 ms)\nstd dev              229.8
  ms   (195.0 ms .. 239.7 ms)\nvariance introduced by outliers: 73% (severely inflated)\n\n```\n\n##
  Acknowledgement\n\nClifford Wolf's [VlogHammer](http://www.clifford.at/yosys/vloghammer.html)
  is an\nexisting Verilog fuzzer that generates random Verilog to test how expressions\nare
  handled in synthesis tools and simulators. It was the inspiration for the\ngeneral
  structure of this fuzzer, which extends the fuzzing to the behavioural\nparts of
  Verilog.\n\nTom Hawkins' Verilog parser was used to write the lexer, the parser
  was then\nrewritten using [Parsec](https://hackage.haskell.org/package/parsec).\n"
license-name: BSD-3-Clause
