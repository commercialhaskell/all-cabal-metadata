all-versions:
- 0.1.0.0
author: Junji Hashimoto
basic-deps:
  base: '>=4.14 && <5'
  bytestring: '>=0.10 && <0.13'
  vector: '>=0.12 && <0.14'
changelog: ''
changelog-type: ''
description: "# webgpu-dawn\n\nHigh-level Haskell bindings to Google's [Dawn WebGPU](https://dawn.googlesource.com/dawn)
  implementation for GPU computing and graphics programming.\n\n## Features\n\n- **Type-safe
  GPU Computing**: Compile and run WGSL compute shaders with automatic resource management\n-
  **Graphics Rendering**: Support for vertex/fragment shaders and render pipelines\n-
  **Automatic Setup**: Dawn is downloaded and built automatically during package installation\n-
  **Cross-platform**: Supports macOS (Metal), Linux (Vulkan), and Windows (D3D12)\n-
  **Zero-copy Data Transfer**: Efficient CPU↔GPU data transfer using `vector` and
  `Storable`\n- **Safe Resource Management**: Automatic cleanup with Haskell's resource
  management patterns\n\n## Quick Start\n\n### Installation\n\n```bash\ncabal update\ncabal
  install webgpu-dawn\n```\n\nThe first build will download and compile Dawn (~10-15
  minutes). Subsequent builds are fast.\n\n### Simple Example\n\n```haskell\nimport
  Graphics.WebGPU.Dawn\nimport qualified Data.Vector.Storable as V\n\nmain :: IO ()\nmain
  = withContext $ \\ctx -> do\n  -- Create GPU tensors\n  let a = V.fromList [1, 2,
  3, 4] :: V.Vector Float\n      b = V.fromList [5, 6, 7, 8] :: V.Vector Float\n      shape
  = Shape [4]\n\n  tensorA <- createTensorWithData ctx shape a\n  tensorB <- createTensorWithData
  ctx shape b\n  tensorC <- createTensor ctx shape F32\n\n  -- Compile shader\n  let
  shader = unlines\n        [ \"@group(0) @binding(0) var<storage, read> a: array<f32>;\"\n
  \       , \"@group(0) @binding(1) var<storage, read> b: array<f32>;\"\n        ,
  \"@group(0) @binding(2) var<storage, read_write> c: array<f32>;\"\n        , \"\"\n
  \       , \"@compute @workgroup_size(256)\"\n        , \"fn main(@builtin(global_invocation_id)
  gid: vec3<u32>) {\"\n        , \"  c[gid.x] = a[gid.x] + b[gid.x];\"\n        ,
  \"}\"\n        ]\n\n  code <- createKernelCode shader\n  kernel <- compileKernel
  ctx code [tensorA, tensorB, tensorC]\n                         (WorkgroupSize 1
  1 1)\n\n  -- Execute on GPU\n  dispatchKernel ctx kernel\n\n  -- Read results\n
  \ result <- fromGPU ctx tensorC 4\n  print result  -- [6.0, 8.0, 10.0, 12.0]\n```\n\n##
  Examples\n\nThe package includes several examples demonstrating different use cases:\n\n###
  GPU Computing Examples\n\n- **VectorAdd.hs**: Basic element-wise vector addition\n-
  **MatrixMultiply.hs**: Optimized matrix multiplication with performance comparison\n-
  **Convolution.hs**: 2D image convolution with various filters (blur, edge detection,
  sharpen)\n\n### Graphics Examples\n\n- **Triangle.hs**: Basic triangle rendering
  with vertex colors\n- **TexturedQuad.hs**: Texture mapping with transformation matrices\n-
  **Cube3D.hs**: 3D rendering with Phong lighting model\n\n### Hybrid Examples\n\n-
  **ParticleSimulation.hs**: Physics simulation using compute shaders with graphical
  rendering\n\nRun examples with:\n\n```bash\ncd examples/compute\ncabal run VectorAdd\n```\n\n##
  API Overview\n\n### Context Management\n\n```haskell\nwithContext :: (Context ->
  IO a) -> IO a\ncreateContext :: IO Context\ndestroyContext :: Context -> IO ()\n```\n\n###
  Tensor Operations\n\n```haskell\n-- Create tensors\ncreateTensor :: Context -> Shape
  -> NumType -> IO Tensor\ncreateTensorWithData :: TensorData a => Context -> Shape
  -> Vector a -> IO Tensor\n\n-- Data transfer\ntoGPU :: TensorData a => Context ->
  Tensor -> Vector a -> IO ()\nfromGPU :: TensorData a => Context -> Tensor -> Int
  -> IO (Vector a)\n\n-- Supported types\ninstance TensorData Float\ninstance TensorData
  Double\ninstance TensorData Int32\ninstance TensorData Word32\n```\n\n### Kernel
  Compilation\n\n```haskell\n-- Create and configure shader code\ncreateKernelCode
  :: String -> IO KernelCode\nsetWorkgroupSize :: KernelCode -> WorkgroupSize -> IO
  ()\nsetEntryPoint :: KernelCode -> String -> IO ()\n\n-- Compile and execute\ncompileKernel
  :: Context -> KernelCode -> [Tensor] -> WorkgroupSize -> IO Kernel\ndispatchKernel
  :: Context -> Kernel -> IO ()\n```\n\n### Types\n\n```haskell\ndata Shape = Shape
  [Int]\ndata NumType = F16 | F32 | F64 | I8 | I16 | I32 | I64 | U8 | U16 | U32 |
  U64\ndata WorkgroupSize = WorkgroupSize { workgroupX, workgroupY, workgroupZ ::
  Int }\n```\n\n## Configuration\n\n### Environment Variables\n\n- `DAWN_HOME`: Custom
  installation directory (default: `~/.cache/dawn`)\n- `DAWN_VERSION`: Specific Dawn
  commit to use (default: tested commit)\n- `DAWN_SKIP_BUILD`: Skip building Dawn
  (assumes system installation)\n\n### Platform Support\n\n| Platform | Backend |
  Status |\n|----------|---------|--------|\n| macOS (Apple Silicon) | Metal | ✅ Supported
  |\n| macOS (Intel) | Metal | ✅ Supported |\n| Linux (x86_64) | Vulkan | ✅ Supported
  |\n| Windows | D3D12 | \U0001F6A7 Experimental |\n\n## Architecture\n\n```\nwebgpu-dawn\n├──
  Setup.hs                  # Custom Cabal setup (downloads/builds Dawn)\n├── cbits/\n│
  \  ├── gpu_wrapper.h         # C API header\n│   ├── gpu_wrapper.c         # C helper
  functions\n│   └── gpu_cpp_bridge.cpp    # C++ wrapper around gpu.cpp\n├── src/Graphics/WebGPU/Dawn/\n│
  \  ├── Internal.hs           # Low-level FFI bindings\n│   ├── Types.hs              #
  Type definitions\n│   ├── Context.hs            # Context management\n│   ├── Tensor.hs
  \            # Tensor operations\n│   └── Kernel.hs             # Kernel compilation/execution\n└──
  examples/                 # Example programs\n```\n\n## Dependencies\n\n### Build
  Dependencies\n\n- CMake 3.14+\n- Git\n- C++17 compiler (clang++/g++/MSVC)\n- Platform-specific:\n
  \ - macOS: Xcode Command Line Tools\n  - Linux: Vulkan drivers (`libvulkan1`, `mesa-vulkan-drivers`)\n
  \ - Windows: Visual Studio 2019+\n\n### Runtime Dependencies\n\nNone! The Dawn shared
  library is bundled with the package.\n\n## Troubleshooting\n\n### Dawn Build Fails\n\n```bash\n#
  Clean and rebuild\nrm -rf ~/.cache/dawn\ncabal clean\ncabal configure\ncabal build\n```\n\n###
  Linker Errors on macOS\n\nThe package automatically adds `-ld_classic` for macOS.
  If you still see errors:\n\n```bash\nexport DAWN_SKIP_BUILD=1\n# Install Dawn manually
  and ensure it's in your library path\n```\n\n### GPU Not Found\n\nEnsure your system
  has compatible GPU drivers:\n\n```bash\n# Linux\nsudo apt install vulkan-tools\nvulkaninfo\n\n#
  macOS\nsystem_profiler SPDisplaysDataType\n```\n\n## Performance Tips\n\n1. **Batch
  Operations**: Compile kernels once, dispatch multiple times\n2. **Minimize Transfers**:
  Keep data on GPU when possible\n3. **Workgroup Size**: Tune for your GPU (typically
  multiples of 32/64)\n4. **Shared Memory**: Use workgroup-local storage for tiled
  algorithms\n\n## Contributing\n\nContributions are welcome! Areas for improvement:\n\n-
  [ ] Graphics pipeline API (render passes, vertex buffers)\n- [ ] Texture and sampler
  support\n- [ ] Async compute operations\n- [ ] Window integration (GLFW/SDL bindings)\n-
  [ ] More numeric types (F16 support)\n- [ ] Profiling and debugging tools\n\n##
  License\n\nMIT License - see LICENSE file for details.\n\n## Acknowledgments\n\nThis
  project builds upon and includes code from several open-source projects:\n\n###
  Dawn (Google)\n- **Project**: [Dawn - Chrome's WebGPU implementation](https://dawn.googlesource.com/dawn)\n-
  **License**: BSD 3-Clause License\n- **Usage**: Core WebGPU runtime, automatically
  downloaded and built during installation\n- **Copyright**: Copyright 2017-2024 The
  Dawn & Tint Authors\n\n### gpu.cpp (Answer.AI)\n- **Project**: [gpu.cpp - Minimal
  GPU compute library](https://github.com/AnswerDotAI/gpu.cpp)\n- **License**: Apache
  License 2.0\n- **Usage**: High-level C++ API wrapper included in `cbits/gpu.hpp`\n-
  **Copyright**: Copyright (c) 2024 Answer.AI\n- **Note**: This project uses gpu.hpp
  to provide a simplified interface to Dawn's native APIs\n\n### GLFW (Optional)\n-
  **Project**: [GLFW - Multi-platform library for OpenGL/Vulkan](https://github.com/glfw/glfw)\n-
  **License**: zlib/libpng License\n- **Usage**: Window management for graphics examples
  (when built with `-fglfw` flag)\n- **Copyright**: Copyright (c) 2002-2006 Marcus
  Geelnard, Copyright (c) 2006-2019 Camilla Löwy\n\n### WebGPU Specification\n- **Project**:
  [WebGPU W3C Specification](https://www.w3.org/TR/webgpu/)\n- **License**: W3C Software
  and Document License\n- **Usage**: API design follows the WebGPU standard\n\nSee
  `cbits/THIRD_PARTY_LICENSES.md` for complete license texts.\n\n### Special Thanks\n-
  The Dawn team at Google for creating an excellent WebGPU implementation\n- Answer.AI
  for developing gpu.cpp and providing a clean C++ API\n- The WebGPU community for
  developing the specification\n\n## Links\n\n- [Documentation](https://hackage.haskell.org/package/webgpu-dawn)\n-
  [Issue Tracker](https://github.com/yourusername/webgpu-dawn/issues)\n- [WebGPU Shading
  Language Spec](https://www.w3.org/TR/WGSL/)\n\n## Contact\n\nMaintainer: Junji Hashimoto
  <junji.hashimoto@gmail.com>\n"
description-type: markdown
hash: f263353a4b2e03fa9bc0272884828cd1c5f7072fb09f04142730aaa2f07379a2
homepage: https://github.com/junjihashimoto/webgpu-dawn
latest: 0.1.0.0
license-name: MIT
maintainer: junji.hashimoto@gmail.com
synopsis: Haskell bindings to WebGPU Dawn for GPU computing and graphics
test-bench-deps:
  base: '>=0'
  hspec: '>=2.7'
  webgpu-dawn: '>=0'
