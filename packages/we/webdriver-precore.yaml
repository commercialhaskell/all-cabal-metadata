all-versions:
- 0.0.0.2
- 0.0.0.3
- 0.0.0.4
- 0.1.0.0
- 0.1.0.1
- 0.1.0.2
- 0.2.0.0
- 0.2.0.1
author: John Walker, Adrian Glouftsis
basic-deps:
  aeson: '>=1.4 && <2.3'
  base: '>=4.16 && <5'
  bytestring: '>=0.10 && <0.12.3'
  containers: '>=0.6 && <0.9'
  text: '>=2.1 && <2.2'
  vector: '>=0.12 && <0.14'
  webdriver-precore: '>=0'
changelog: "# webdriver-precore-0.2.0.1 (2026-01-17)\n\n## Breaking Changes\n\n###
  Module Restructure\n\nThe library has been reorganized to support both HTTP and
  BiDi protocols:\n\n- `WebDriverPreCore.SpecDefinition` deleted. Use `WebDriverPreCore.HTTP.API`
  or the deprecated `WebDriverPreCore.HTTP.SpecDefinition`\n- `WebDriverPreCore.Capabilities`
  → `WebDriverPreCore.HTTP.Capabilities` \n- `WebDriverPreCore.HttpResponse` → `WebDriverPreCore.HTTP.HttpResponse`\n\nMain
  module exports updated to reflect new structure. Import from `WebDriverPreCore.HTTP.*`
  for HTTP protocol or `WebDriverPreCore.BiDi.*` for BiDi protocol.\n\n### Type Renames\n\n-
  `W3Spec` → `Command` (in `WebDriverPreCore.HTTP.Protocol`)\n- `SessionId` → `Session`
  (constructor: `MkSession`)\n- `WebDriverErrorType` → `ErrorType`\n- `ScriptTimeoutError`
  → `ScriptTimeout`\n- Error functions renamed:\n  - `errorCodeToErrorType` → `toErrorType`\n
  \ - `errorTypeToErrorCode` → `toErrorCode`\n  - `parseWebDriverError` → `parseWebDriverException`\n
  \ - `parseWebDriverErrorType` → `parseErrorType`\n\n### HTTP API Changes\n\n**Status
  endpoint**: Return type changed from `DriverStatus` to `Status`. The `Status` type
  correctly implements the spec:\n- `ready` field indicates if server accepts commands\n-
  `message` field provides additional info\n- Previous implementation incorrectly
  returned `ready` as status\n\n**New session**: Now returns `SessionResponse` containing:\n-
  `sessionId :: Session` (the session ID)\n- `webSocketUrl :: Maybe Text` (for BiDi
  connections)\n- `capabilities :: Capabilities` (matched capabilities)\n- `extensions
  :: Maybe (Map Text Value)` (extension-specific data)\n\n**Response parsing**: The
  `Command` type in the new API no longer exposes a `parser` field. Extract the response
  body value and call `parseJSON` on it. For migration examples, see [HTTP test runners](https://github.com/pyrethrum/webdriver/tree/main/webdriver-precore/test/HTTP).\n\n###
  Migration Guide\n\n1. Update imports:\n   ```haskell\n   -- Old\n   import WebDriverPreCore.SpecDefinition\n
  \  \n   -- New\n   import WebDriverPreCore.HTTP.API\n   ```\n\n2. Update types in
  code:\n   ```haskell\n   -- Old\n   spec :: W3Spec a\n   sessionId :: SessionId\n
  \  errType :: WebDriverErrorType\n   \n   -- New  \n   cmd :: Command a\n   session
  :: Session\n   errType :: ErrorType\n   ```\n\n3. Handle new session response:\n
  \  ```haskell\n   -- Old: newSession returned SessionId\n   sessionId <- runCommand
  $ newSession caps\n   \n   -- New: newSession returns SessionResponse\n   sessionResp
  <- runCommand $ newSession caps\n   let session = sessionResp.sessionId       --
  Session type\n       wsUrl = sessionResp.webSocketUrl      -- for BiDi connection\n
  \      caps = sessionResp.capabilities       -- matched capabilities\n   ```\n\n4.
  Update error handling:\n   ```haskell\n   -- Old\n   errorCodeToErrorType code\n
  \  \n   -- New\n   toErrorType code\n   ```\n\n## Deprecations\n\n`WebDriverPreCore.HTTP.SpecDefinition`
  module deprecated (removal ~2027-02-01). This module provides backward compatibility
  with the old `SpecDefinition` API using the deprecated name `HttpSpec` for the spec
  type. Migrate to `WebDriverPreCore.HTTP.API` which uses the `Command` type.\n\n##
  New Features\n\n### BiDi Protocol Support\n\nComplete implementation of W3C WebDriver
  BiDi protocol, including:\n\n- **Session management**: Connection setup, capability
  negotiation\n- **Browsing contexts**: Navigation, context management, tree traversal\n-
  **Script evaluation**: JavaScript execution, realm management, channel messaging\n-
  **Network**: Request interception, authentication, response modification\n- **Input**:
  Actions for keyboard, mouse, wheel\n- **Storage**: Cookie and storage partition
  management\n- **Events**: Subscriptions for logs, network events, browsing context
  lifecycle, script realm events\n- **Emulation**: User agent, viewport configuration\n-
  **Browser**: Process management, user context handling\n- **WebExtensions**: Install
  and uninstall browser extensions (experimental)\n\nSee `WebDriverPreCore.BiDi.API`
  for commands and `WebDriverPreCore.BiDi.Protocol` for types.\n\n### Error Handling
  Improvements\n\n- Added 17 BiDi-specific error types\n- `ErrorType` now derives
  `FromJSON` for direct parsing\n- Improved error-to-code conversion with proper camelCase
  handling\n\n## Bug Fixes\n\n- Status endpoint implementation corrected to match
  W3C spec\n- Fixed session status data structure (was incorrectly returning `ready`
  as the status value)\n\n## Examples\n\nSee [test directory](https://github.com/pyrethrum/webdriver/tree/main/webdriver-precore/test)
  for HTTP and BiDi usage examples\n\n# webdriver-precore-0.1.0.2 (2025-05-17)\n\nFix
  Hackage build failure (ghc-9.8.4)\n\n# webdriver-precore-0.1.0.1 (2025-04-28)\n\nREADME
  update - Stackage badge\n\n# webdriver-precore-0.1.0.0 (2025-04-27)\n\nDowngrade
  `cabal-version:` from  `3.12` => `3.8` for Stackage compatibility\n\n# webdriver-precore-0.0.0.4
  (2025-04-21)\n\nFix another typo (bad repo examples link)\n\n# webdriver-precore-0.0.0.3
  (2025-04-21)\n\nA few documentation typos and bump version of Vector dependencies\n\n#
  webdriver-precore-0.0.0.2 (2025-04-21)\n\nThe initial release of this library.\n\nSee
  [README](README.md) for details"
changelog-type: markdown
description: "# webdriver-precore\n\n![build](https://github.com/pyrethrum/webdriver/actions/workflows/cicd.yaml/badge.svg?branch=main)\n[![Hackage](https://img.shields.io/hackage/v/webdriver-precore.svg)](https://hackage.haskell.org/package/webdriver-precore)\n[![Stackage
  Nightly](http://stackage.org/package/webdriver-precore/badge/nightly)](http://stackage.org/nightly/package/webdriver-precore)\n\n\n<!--
  \nAdapt and move when ready\n![CI](https://github.com/commercialhaskell/path/workflows/CI/badge.svg?branch=master)\n[![Stackage
  LTS](http://stackage.org/package/path/badge/lts)](http://stackage.org/lts/package/path)\n[![Stackage
  Nightly](http://stackage.org/package/path/badge/nightly)](http://stackage.org/nightly/package/path)
  \n-->\n\n\n## What is This Library?\n\nThis library provides typed definitions for
  the W3C WebDriver Protocol, supporting both the [HTTP](https://www.w3.org/TR/2025/WD-webdriver2-20251028/)
  and the [BiDi](https://www.w3.org/TR/2025/WD-webdriver-bidi-20251212/) protocols.\n\nThis
  library is intended as a foundation for building WebDriver client implementations.
  **It is type constructors only**, and does not include any executable client code.\n\nIf
  you are writing a webdriver client, this library will save you the effort of analysing
  the specs and implementing the protocol types and JSON instances.\n\nIf you are
  looking for a library to enable you to interact with web pages directly then you
  need a fully implemented web client library **which this library is not**.\n\nFor
  a fully implemented webdriver client, consider an alternative such as [haskell-webdriver](https://github.com/haskell-webdriver/haskell-webdriver#readme)\n\n##
  Why This Library?\n\nSeveral libraries provide WebDriver bindings for Haskell. However,
  when development on this library began, the existing options were either unmaintained,
  dependent on Selenium, or tightly coupled with larger \"batteries included\" testing
  frameworks.\n\nWe, the authors of this library, are building our own stand-alone
  test framework. To support browser based testing within this framework we're first
  creating a series of independent low-level libraries. This library is the first
  in that series. Our aim is to make each of our low level libraries broadly useful
  to others, outside its use within our own framework. \n\n### Core Principles\n-
  **Direct W3C WebDriver Implementation**  \n  - No Selenium dependency  \n  - Full
  control over protocol handling  \n  *Note: the [W3C WebDriver standard](https://www.w3.org/TR/webdriver2/)
  is an initiative driven largely by the core Selenium contributors. It provides a
  uniform HTTP API to drive browsers, and can be leveraged by any library, including
  Selenium.*\n\n- **Minimalist Design**  \n  - Boring Haskell\n  - Few external dependencies
  \ \n\n- **Enable a Layered Architecture**  \n  - Provide an unopinionated WebDriver
  client for use in higher level libraries\n\n### Library Non-Goals\n  \nThe following
  features are not included in this library. They belong in downstream libraries.\n
  \ * Convenience or utility functions, that do not directly correspond to an endpoint
  on the W3C spec.\n  * Transformers, effects or similar abstractions. \n  * Bespoke
  variations from the spec to accommodate non-standard driver behaviour.\n\n### Acknowledgements\n\nThis
  library would not have been possible without the prior work in: \n\n**Haskell (particularly)**:\n*
  [haskell-webdriver](https://hackage.haskell.org/package/webdriver)\n* [webdriver-w3c](https://hackage.haskell.org/package/webdriver-w3c)\n\n**Selenium
  and WebDriver Standards**:\n\nThe decade+ efforts of the [Selenium](https://www.selenium.dev/)
  maintainers, both in forging the way with Selenium and their ongoing work in the
  development of the W3C standards, both [HTTP](https://www.w3.org/TR/webdriver2/)
  and [BiDi](https://www.w3.org/TR/webdriver-bidi/)\n\n## Further Details\n\nFor further
  details on the structure and use of this library see the [Hackage Docs](https://hackage.haskell.org/package/webdriver-precore).\n\nFor
  runnable demos and source code for an example client implementation see the [test
  directory of this repository](./test/README.md).\n"
description-type: markdown
hash: 2c644f12cb915bd6491da97af448bb74270cdcee8260f4a39f11c7594b6153c4
homepage: https://github.com/pyrethrum/webdriver-precore#readme
latest: 0.2.0.1
license-name: BSD-3-Clause
maintainer: theghostjw@gmail.com
synopsis: A typed wrapper for W3C WebDriver (HTTP and BiDi) protocols.
test-bench-deps:
  aeson: '>=0'
  base: '>=0'
  base64: '>=0'
  bytestring: '>=0'
  containers: '>=0'
  dhall: '>=0'
  directory: '>=1.3 && <1.4'
  falsify: '>=0'
  filepath: '>=0'
  ghc: '>=0'
  network: '>=0'
  pretty-show: ^>=1.10
  raw-strings-qq: '>=0'
  req: '>=0'
  tasty: '>=0'
  tasty-hunit: '>=0'
  text: '>=0'
  time: '>=0'
  unliftio: '>=0'
  webdriver-precore: '>=0'
  websockets: '>=0'
